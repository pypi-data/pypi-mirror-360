"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["12697"],{55815:function(t,e,n){n.d(e,{Eu:function(){return s},hZ:function(){return o},o9:function(){return c}});n(24819),n(54480);var i=n(28105),a=n(45657),r=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function s(t){return r[t%r.length]}function o(t,e){var n=e.getPropertyValue("--graph-color-".concat(t+1))||s(t);return(0,a.Rq)(n)}var c=(0,i.Z)(function(t){return r.map(function(e,n){return o(n,t)})},function(t,e){return t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1")})},84447:function(t,e,n){var i,a,r,s,o=n(54982),c=n(54521),u=n(4490),d=n(20129),l=n(85297),h=n(53389),f=(n(12212),n(87799),n(73742)),p=n(27885),_=n(67522),v=n(23533),g=n(7046),y=n(59048),m=n(7616),b=function(t){function e(){var t;(0,c.Z)(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=(0,d.Z)(this,e,[].concat(i))).filled=!1,t.active=!1,t}return(0,l.Z)(e,t),(0,u.Z)(e,[{key:"renderOutline",value:function(){return this.filled?(0,y.dy)(i||(i=(0,o.Z)(['<span class="filled"></span>']))):(0,h.Z)(e,"renderOutline",this,3)([])}},{key:"getContainerClasses",value:function(){return Object.assign(Object.assign({},(0,h.Z)(e,"getContainerClasses",this,3)([])),{},{active:this.active})}},{key:"renderPrimaryContent",value:function(){return(0,y.dy)(a||(a=(0,o.Z)([' <span class="leading icon" aria-hidden="true"> ',' </span> <span class="label">','</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> '," </span> "])),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}},{key:"renderTrailingIcon",value:function(){return(0,y.dy)(r||(r=(0,o.Z)(['<slot name="trailing-icon"></slot>'])))}}])}(p.g);b.styles=[v.W,g.W,_.W,(0,y.iv)(s||(s=(0,o.Z)([":host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(\n          --ha-assist-chip-container-shape,\n          16px\n        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}"])))],(0,f.__decorate)([(0,m.Cb)({type:Boolean,reflect:!0})],b.prototype,"filled",void 0),(0,f.__decorate)([(0,m.Cb)({type:Boolean})],b.prototype,"active",void 0),b=(0,f.__decorate)([(0,m.Mo)("ha-assist-chip")],b)},7214:function(t,e,n){n.d(e,{Cj:function(){return h},F7:function(){return a},Hs:function(){return x},Kd:function(){return S},Kj:function(){return p},Nw:function(){return v},PA:function(){return r},Py:function(){return c},Qm:function(){return C},Z0:function(){return m},_Y:function(){return d},_m:function(){return s},dL:function(){return u},dO:function(){return k},hN:function(){return f},h_:function(){return l},j2:function(){return b},q6:function(){return _},uR:function(){return o}});n(39710),n(26847),n(81738),n(72489),n(56389),n(27530);var i=n(15459),a=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({});const r=99387==n.j?["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"]:null,s=t=>t.sendMessagePromise({type:"recorder/info"}),o=(t,e)=>t.callWS({type:"recorder/list_statistic_ids",statistic_type:e}),c=(t,e)=>t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e}),u=(t,e,n,i,a="hour",r,s)=>t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==n?void 0:n.toISOString(),statistic_ids:i,period:a,units:r,types:s}),d=(t,e,n,i)=>t.callWS({type:"recorder/statistic_during_period",statistic_id:e,units:i,fixed_period:n.fixed_period?{start_time:n.fixed_period.start instanceof Date?n.fixed_period.start.toISOString():n.fixed_period.start,end_time:n.fixed_period.end instanceof Date?n.fixed_period.end.toISOString():n.fixed_period.end}:void 0,calendar:n.calendar,rolling_window:n.rolling_window}),l=t=>t.callWS({type:"recorder/validate_statistics"}),h=(t,e,n)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:n}),f=(t,e)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:e}),p=t=>{let e=null;if(!t)return null;for(const n of t)null!==n.change&&void 0!==n.change&&(null===e?e=n.change:e+=n.change);return e},_=(t,e)=>{let n=null;for(const i of e){if(!(i in t))continue;const e=p(t[i]);null!==e&&(null===n?n=e:n+=e)}return n},v=(t,e)=>t.some(t=>void 0!==t[e]&&null!==t[e]),g=["mean","min","max"],y=["sum","state","change"],m=(t,e)=>!(!g.includes(e)||0===t.mean_type)||!(!y.includes(e)||!t.has_sum),b=(t,e,n,i,a)=>{const r=new Date(n).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:r,adjustment:i,adjustment_unit_of_measurement:a})},S=(t,e,n)=>{const a=t.states[e];return a?(0,i.C)(a):(null==n?void 0:n.name)||e},k=(t,e,n)=>{let i;var a;e&&(i=null===(a=t.states[e])||void 0===a?void 0:a.attributes.unit_of_measurement);return void 0===i?null==n?void 0:n.statistics_unit_of_measurement:i},x=t=>t.includes(":"),C=t=>t.callWS({type:"recorder/update_statistics_issues"})},6291:function(t,e,n){n.d(e,{f:function(){return l}});var i=n(75706),a=n(54521),r=n(4490),s=n(20129),o=n(53389),c=n(85297),u=(n(39710),n(26847),n(81738),n(72489),n(54480),n(1455),n(56389),n(27530),n(73742)),d=n(7616),l=function(t){var e=function(t){function e(){return(0,a.Z)(this,e),(0,s.Z)(this,e,arguments)}return(0,c.Z)(e,t),(0,r.Z)(e,[{key:"connectedCallback",value:function(){(0,o.Z)(e,"connectedCallback",this,3)([]),this._checkSubscribed()}},{key:"disconnectedCallback",value:function(){if((0,o.Z)(e,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){var t=this.__unsubs.pop();t instanceof Promise?t.then(function(t){return t()}):t()}this.__unsubs=void 0}}},{key:"updated",value:function(t){if((0,o.Z)(e,"updated",this,3)([t]),t.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps){var n,a=(0,i.Z)(t.keys());try{for(a.s();!(n=a.n()).done;){var r=n.value;if(this.hassSubscribeRequiredHostProps.includes(r))return void this._checkSubscribed()}}catch(s){a.e(s)}finally{a.f()}}}},{key:"hassSubscribe",value:function(){return[]}},{key:"_checkSubscribed",value:function(){var t,e=this;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some(function(t){return void 0===e[t]})||(this.__unsubs=this.hassSubscribe())}}])}(t);return(0,u.__decorate)([(0,d.Cb)({attribute:!1})],e.prototype,"hass",void 0),e}},68669:function(t,e,n){n.a(t,async function(t,i){try{n.r(e),n.d(e,{HuiEnergyDevicesGraphCard:function(){return M}});var a,r,s,o=n(29694),c=n(75778),u=n(54982),d=n(42385),l=n(54521),h=n(4490),f=n(67063),p=n(20129),_=n(85297),v=(n(12212),n(70021),n(24819),n(2394),n(18574),n(81738),n(29981),n(22960),n(6989),n(54480),n(67398),n(73742)),g=n(59048),y=n(7616),m=n(31733),b=n(28105),S=n(55815),k=n(28598),x=n(37008),C=n(6640),Z=n(7214),w=n(6291),R=n(93647),W=(n(31138),n(39884)),I=n(3901),D=t([x,C,k]);[x,C,k]=D.then?(await D)():D;var M=function(t){function e(){var t;(0,l.Z)(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=(0,p.Z)(this,e,[].concat(i)))._chartData=[],t.hassSubscribeRequiredHostProps=["_config"],t._createOptions=(0,b.Z)(function(e){var n,i,a=window.matchMedia("all and (max-width: 450px), all and (max-height: 500px)").matches;return{xAxis:{type:"value",name:"kWh"},yAxis:{type:"category",inverse:!0,triggerEvent:!0,data:null===(n=e[0])||void 0===n||null===(n=n.data)||void 0===n?void 0:n.map(function(t){return t.value[1]}),axisLabel:{formatter:t._getDeviceName.bind((0,f.Z)(t)),overflow:"truncate",fontSize:12,margin:5,width:Math.min(a?100:200,Math.max.apply(Math,(0,d.Z)((null===(i=e[0])||void 0===i||null===(i=i.data)||void 0===i?void 0:i.map(function(e){return(0,I.U)(t._getDeviceName(e.value[1]),12)+5}))||[])))}},grid:{top:5,left:5,right:40,bottom:0,containLabel:!0},tooltip:{show:!0,formatter:t._renderTooltip.bind((0,f.Z)(t))}}}),t}return(0,_.Z)(e,t),(0,h.Z)(e,[{key:"hassSubscribe",value:function(){var t,e=this;return[(0,C.UB)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe(function(t){e._data=t,e._getStatistics(t)})]}},{key:"getCardSize",value:function(){return 3}},{key:"setConfig",value:function(t){this._config=t}},{key:"shouldUpdate",value:function(t){return(0,R.SN)(this,t)||t.size>1||!t.has("hass")}},{key:"render",value:function(){var t;return this.hass&&this._config?(0,g.dy)(a||(a=(0,u.Z)([" <ha-card> ",' <div class="content ','"> <ha-chart-base .hass="','" .data="','" .options="','" .height="','" @chart-click="','"></ha-chart-base> </div> </ha-card> '])),this._config.title?(0,g.dy)(r||(r=(0,u.Z)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,m.$)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._chartData),"".concat(28*((null===(t=this._chartData[0])||void 0===t||null===(t=t.data)||void 0===t?void 0:t.length)||0)+50,"px"),this._handleChartClick):g.Ld}},{key:"_renderTooltip",value:function(t){var e='<h4 style="text-align: center; margin: 0;">'.concat(this._getDeviceName(t.value[1]),"</h4>"),n="".concat((0,k.uf)(t.value[0],this.hass.locale,(0,k.l4)(void 0,this.hass.entities[t.value[1]]))," kWh");return"".concat(e).concat(t.marker," ").concat(t.seriesName,": ").concat(n)}},{key:"_getDeviceName",value:function(t){var e,n;return(null===(e=this._data)||void 0===e||null===(e=e.prefs.device_consumption.find(function(e){return e.stat_consumption===t}))||void 0===e?void 0:e.name)||(0,Z.Kd)(this.hass,t,null===(n=this._data)||void 0===n?void 0:n.statsMetadata[t])}},{key:"_getStatistics",value:(n=(0,c.Z)((0,o.Z)().m(function t(e){var n,i,a,r,s,c,u;return(0,o.Z)().w(function(t){for(;;)switch(t.n){case 0:return i=e.stats,a=e.statsCompare,r=[],s=[],c=[{type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:r,barWidth:a?10:20,cursor:"default"}],a&&c.push({type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.previous_energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:s,barWidth:10,cursor:"default"}),u=getComputedStyle(this),e.prefs.device_consumption.forEach(function(t,e){var n=t.stat_consumption in i&&(0,Z.Kj)(i[t.stat_consumption])||0,o=(0,S.hZ)(e,u);if(r.push({id:e,value:[n,t.stat_consumption],itemStyle:{color:o+"7F",borderColor:o}}),a){var c=t.stat_consumption in a&&(0,Z.Kj)(a[t.stat_consumption])||0;s.push({id:e,value:[c,t.stat_consumption],itemStyle:{color:o+"32",borderColor:o+"7F"}})}}),r.sort(function(t,e){return e.value[0]-t.value[0]}),r.length=Math.min((null===(n=this._config)||void 0===n?void 0:n.max_devices)||1/0,r.length),this._chartData=c,t.n=1,this.updateComplete;case 1:return t.a(2)}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"_handleChartClick",value:function(t){"axisLabel"===t.detail.targetType&&t.detail.value&&!(0,Z.Hs)(t.detail.value)&&(0,W.B)(this,"hass-more-info",{entityId:t.detail.value})}}]);var n}((0,w.f)(g.oi));M.styles=(0,g.iv)(s||(s=(0,u.Z)([".card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}ha-chart-base{--chart-max-height:none}"]))),(0,v.__decorate)([(0,y.Cb)({attribute:!1})],M.prototype,"hass",void 0),(0,v.__decorate)([(0,y.SB)()],M.prototype,"_config",void 0),(0,v.__decorate)([(0,y.SB)()],M.prototype,"_chartData",void 0),(0,v.__decorate)([(0,y.SB)()],M.prototype,"_data",void 0),M=(0,v.__decorate)([(0,y.Mo)("hui-energy-devices-graph-card")],M),i()}catch(O){i(O)}})},3901:function(t,e,n){n.d(e,{U:function(){return a}});var i;n(12212);function a(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Roboto, Noto, sans-serif";i||(i=document.createElement("canvas"));var a=i.getContext("2d");if(!a)return 0;a.font="".concat(e,"px ").concat(n);var r=a.measureText(t);return Math.ceil(Math.max(r.actualBoundingBoxRight+r.actualBoundingBoxLeft,r.width))}},19627:function(t,e,n){n.d(e,{X:function(){return s}});var i=n(40246),a=n(87191),r=n(29426);function s(t,e,n){const s=(0,r._)(t,e)/a.yJ;return(0,i.u)(null==n?void 0:n.roundingMethod)(s)}}}]);
//# sourceMappingURL=12697.336898dfe1dd18a0.js.map