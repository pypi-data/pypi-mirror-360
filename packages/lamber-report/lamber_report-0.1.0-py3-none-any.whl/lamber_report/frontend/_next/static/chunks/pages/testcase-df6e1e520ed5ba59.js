(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[856],{3370:(e,t,s)=>{"use strict";function r(e){return e>1?"s":""}function n(e){let t="",s=Math.floor(e),n=Math.floor(s/31536e3);n&&(t+=n+" year"+r(n));let i=Math.floor((s%=31536e3)/86400);i&&(t+=" "+i+" day"+r(i));let a=Math.floor((s%=86400)/3600);a&&(t+=" "+a+" hour"+r(a));let l=Math.floor((s%=3600)/60);l&&(t+=" "+l+" min"+r(l));let c=s%60;return c&&(t+=" "+c+" sec"+r(c)),t||(t="< 1 sec"),t}function i(e){return e<0||e>0xffffffff?null:"".concat(e>>>24&255,".").concat(e>>>16&255,".").concat(e>>>8&255,".").concat(255&e)}function a(e){switch(e){case"PASS":return"#52c41a";case"FAIL":return"#f5222d";case"ERROR":return"#ff4d4f";case"XPASS":return"#faad14";case"XFAIL":return"#13c2c2";case"ABORT":return"#eb2f96";default:return"#bfbfbf"}}s.d(t,{TT:()=>n,bK:()=>i,dy:()=>a})},49272:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/testcase",function(){return s(89641)}])},58679:(e,t,s)=>{"use strict";s.d(t,{FG:()=>o,HX:()=>c,Kc:()=>x,Rs:()=>a,YK:()=>i,eU:()=>h,fU:()=>u,hO:()=>l,iS:()=>p,zs:()=>d});var r=s(11572);let n=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return fetch(...t).then(e=>e.json())};function i(){let{data:e,error:t,isLoading:s}=(0,r.Ay)("/api/projects",n);return{projects:e,isLoading:s,isError:t}}function a(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/project/test_sessions?project_id=".concat(e),n);return{testSessions:t,isLoading:i,isError:s}}function l(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/test_session/environment?test_session_id=".concat(e),n);return{testSessionEnvironment:t,isLoading:i,isError:s}}function c(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/test_session/result_statistic?test_session_id=".concat(e),n);return{testSessionResultStatistic:t,isLoading:i,isError:s}}function o(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/test_session/testcases?test_session_id=".concat(e),n);return{testSessionTestcases:t,isLoading:i,isError:s}}function d(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/testcase/landing?testcase_id=".concat(e),n);return{testcaseLanding:t,isLoading:i,isError:s}}function u(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/testcase/explorer?testcase_id=".concat(e),n);return{testcaseExplorer:t,isLoading:i,isError:s}}function x(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/testcase/sourcecode?testcase_id=".concat(e),n);return{testresultSourcecode:t,isLoading:i,isError:s}}function h(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/testcase/histories?testcase_id=".concat(e),n);return{testSessionTestcases:t,isLoading:i,isError:s}}function p(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/testcase/pytest_logs?testcase_id=".concat(e),n);return{testcasePytestLogs:t,isLoading:i,isError:s}}},89641:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>F});var r=s(5640),n=s(77583),i=s(81386),a=s(46373),l=s(46934),c=s(87057),o=s.n(c),d=s(40838),u=s(24671),x=s(11149),h=s(79422),p=s(41488),j=s(35745),A=s(71415),m=s(30983),y=s(44189),f=s(3370),g=s(58679);let{Title:S}=j.A;function _(e){let{testcaseId:t}=e,{testcaseLanding:s,isLoading:n}=(0,g.zs)(t);return n?(0,r.jsx)("div",{children:"Loading..."}):(0,r.jsxs)(a.A,{direction:"vertical",style:{display:"flex"},size:"small",children:[(0,r.jsxs)(a.A,{size:"small",style:{display:"flex"},children:[s.result?(0,r.jsx)(A.A,{color:(0,f.dy)(s.result),children:s.result}):(0,r.jsx)(y.A,{}),(0,r.jsx)(S,{copyable:!0,level:4,style:{margin:0},children:s.nodeid}),(0,r.jsx)(A.A,{color:"processing",children:(0,f.TT)(s.duration)}),s.marker?JSON.parse(s.marker).map(e=>"parametrize"==e.name?"":(0,r.jsx)(A.A,{color:"processing",children:e.name},e.name)):(0,r.jsx)(r.Fragment,{})]}),(0,r.jsx)(m.A,{items:[{key:"1",label:"Start Time",children:new Date(1e3*s.start_time).toLocaleString("zh-CN")},{key:"2",label:"Stop Time",children:s.stop_time?new Date(1e3*s.stop_time).toLocaleString("zh-CN"):(0,r.jsx)(r.Fragment,{})}]})]})}var k=s(98040),v=s(2874),I=s(82808),b=s(27548);function w(e){let{testcaseId:t}=e,{testcaseExplorer:s,isLoading:n}=(0,g.fU)(t);return n?(0,r.jsx)("div",{children:"Loading..."}):(console.log(s),(0,r.jsx)(k.A,{size:"small",style:{textAlign:"left"},defaultActiveKey:s.traceback?["1","2"]:["1"],items:[{key:"1",label:"Step Tree",children:(0,r.jsx)(v.A,{defaultExpandAll:!0,treeData:s.steps,titleRender:e=>(0,r.jsxs)(a.A,{size:"small",children:[e.result?(0,r.jsx)(A.A,{bordered:!1,color:(0,f.dy)(e.result),children:e.result}):(0,r.jsx)(y.A,{}),e.title,e.scope?(0,r.jsx)(A.A,{color:"success",children:e.scope}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)(A.A,{color:"processing",children:new Date(1e3*e.start_time).toLocaleString("zh-CN")})]})})},{key:"2",label:"Traceback",children:s.traceback?(0,r.jsx)(b.A,{language:"python",customStyle:{textAlign:"left"},children:JSON.parse(s.traceback).join("\n\n")}):(0,r.jsx)(I.A,{})}]}))}var T=s(62077);function E(e){let{testcaseId:t}=e,{testresultSourcecode:s,isLoading:n}=(0,g.Kc)(t);return n?(0,r.jsx)("div",{children:"Loading..."}):(0,r.jsx)(T.A,{style:{textAlign:"left"},items:[{key:"1",label:"Sourcecode",children:(0,r.jsx)(b.A,{language:"python",children:s.sourcecode})}]})}var N=s(96629);function R(e){let{testcaseId:t,testSessionId:s,projectName:n,projectId:i}=e,{testSessionTestcases:a,isLoading:l}=(0,g.eU)(t);return l?(0,r.jsx)("div",{children:"Loading..."}):(0,r.jsx)(N.A,{testSessionId:s,testSessionTestcases:a,projectName:n,projectId:i})}function L(e){let{testcaseId:t,testSessionId:s,projectName:n,projectId:i}=e,{testcasePytestLogs:a,isLoading:l}=(0,g.iS)(t);return l?(0,r.jsx)("div",{children:"Loading..."}):(0,r.jsx)(T.A,{style:{textAlign:"left"},items:[{key:"1",label:"Caplog",children:a.caplog?(0,r.jsx)(b.A,{language:"bash",children:a.caplog}):(0,r.jsx)(I.A,{})},{key:"2",label:"Capstderr",children:a.capstderr?(0,r.jsx)(b.A,{language:"bash",children:a.capstderr}):(0,r.jsx)(I.A,{})},{key:"3",label:"Capstdout",children:a.capstdout?(0,r.jsx)(b.A,{language:"bash",children:a.capstdout}):(0,r.jsx)(I.A,{})},{key:"4",label:"Histories",children:(0,r.jsx)(R,{testcaseId:t,testSessionId:s,projectName:n,projectId:i})}]})}function F(){let e=(0,p.useRouter)(),t=e.query.projectId,s=e.query.projectName,c=e.query.testSessionId,j=e.query.testSessionStartTime,A=e.query.testcaseId,m=e.query.testcaseNodeid;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{separator:">",items:[{title:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.A,{}),(0,r.jsx)(o(),{href:"/",children:"Home"})]})},{title:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.A,{}),(0,r.jsx)(o(),{href:{pathname:"/project",query:{projectId:t,projectName:s}},children:s})]})},{title:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{}),(0,r.jsx)(o(),{href:{pathname:"/test_session",query:{projectId:t,projectName:s,testSessionId:c,testSessionStartTime:j}},children:new Date(1e3*parseFloat(j)).toLocaleString("zh-CN")})]})},{title:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.A,{}),(0,r.jsx)("span",{children:m})]})}]}),(0,r.jsx)(i.A,{}),(0,r.jsxs)(a.A,{direction:"vertical",style:{display:"flex"},children:[(0,r.jsx)(_,{testcaseId:A}),(0,r.jsxs)(l.A,{style:{height:"calc(100vh - 220px)"},children:[(0,r.jsx)(l.A.Panel,{defaultSize:"30%",collapsible:!0,style:{marginRight:"8px"},children:(0,r.jsx)(w,{testcaseId:A})}),(0,r.jsx)(l.A.Panel,{collapsible:!0,style:{marginLeft:"8px"},children:(0,r.jsxs)(l.A,{layout:"vertical",children:[(0,r.jsx)(l.A.Panel,{children:(0,r.jsx)(E,{testcaseId:A})}),(0,r.jsx)(l.A.Panel,{style:{marginTop:"8px"},children:(0,r.jsx)(L,{testcaseId:A,testSessionId:c,projectName:s,projectId:t})})]})})]})]})]})}},96629:(e,t,s)=>{"use strict";s.d(t,{A:()=>f});var r=s(5640),n=s(3370),i=s(20844),a=s(44189),l=s(69491),c=s(78180),o=s(46373),d=s(6989),u=s(71415),x=s(32666),h=s(87057),p=s.n(h),j=s(50148),A=s(12921),m=s.n(A),y=s(27548);function f(e){let{testSessionId:t,testSessionTestcases:s,projectName:h,projectId:A}=e,[f,g]=(0,j.useState)(""),[S,_]=(0,j.useState)(""),k=(0,j.useRef)(null),v=(e,t,s)=>{t(),g(e[0]),_(s)},I=e=>{e(),g("")},b=e=>({filterDropdown:t=>{let{setSelectedKeys:s,selectedKeys:n,confirm:a,clearFilters:l,close:u}=t;return(0,r.jsxs)("div",{style:{padding:8},onKeyDown:e=>e.stopPropagation(),children:[(0,r.jsx)(c.A,{ref:k,placeholder:"Search ".concat(e),value:n[0],onChange:e=>s(e.target.value?[e.target.value]:[]),onPressEnter:()=>v(n,a,e),style:{marginBottom:8,display:"block"}}),(0,r.jsxs)(o.A,{children:[(0,r.jsx)(d.Ay,{type:"primary",onClick:()=>v(n,a,e),icon:(0,r.jsx)(i.A,{}),size:"small",style:{width:90},children:"Search"}),(0,r.jsx)(d.Ay,{onClick:()=>l&&I(l),size:"small",style:{width:90},children:"Reset"}),(0,r.jsx)(d.Ay,{type:"link",size:"small",onClick:()=>{a({closeDropdown:!1}),g(n[0]),_(e)},children:"Filter"}),(0,r.jsx)(d.Ay,{type:"link",size:"small",onClick:()=>{u()},children:"close"})]})]})},filterIcon:e=>(0,r.jsx)(i.A,{style:{color:e?"#1677ff":void 0}}),onFilter:(t,s)=>!!s&&!!s[e]&&s[e].toString().toLowerCase().includes(t.toLowerCase()),filterDropdownProps:{onOpenChange(e){e&&setTimeout(()=>{var e;return null==(e=k.current)?void 0:e.select()},100)}},render:t=>S===e?(0,r.jsx)(m(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[f],autoEscape:!0,textToHighlight:t?t.toString():""}):t}),w=[{title:"Result",dataIndex:"result",key:"result",render:(e,t)=>t.result?(0,r.jsx)(u.A,{color:(0,n.dy)(t.result),children:t.result}):t.start_time?(0,r.jsx)(a.A,{}):(0,r.jsx)(l.A,{}),filters:[{text:"PASS",value:"PASS"},{text:"FAIL",value:"FAIL"},{text:"ERROR",value:"ERROR"},{text:"XPASS",value:"XPASS"},{text:"XFAIL",value:"XFAIL"},{text:"ABORT",value:"ABORT"},{text:"SKIP",value:"SKIP"}],onFilter:(e,t)=>!!t.result&&0===t.result.indexOf(e),width:"8px"},{title:"Start Time",dataIndex:"start_time",key:"start_time",render:(e,s)=>s.start_time?(0,r.jsx)(p(),{href:{pathname:"/testcase",query:{projectId:A,projectName:h,testSessionId:t,testSessionStartTime:s.start_time.toString(),testcaseId:s.uuid,testcaseNodeid:s.nodeid}},children:new Date(1e3*s.start_time).toLocaleString("zh-CN")}):"",sorter:(e,t)=>e.start_time-t.start_time,sortDirections:["descend","ascend"],width:"220px"},{title:"Name",dataIndex:"nodeid",key:"nodeid",...b("nodeid")},{title:"Marker",dataIndex:"marker",key:"marker",...b("marker"),render:e=>e?(0,r.jsx)(o.A,{children:JSON.parse(e).map(e=>"parametrize"==e.name?"":(0,r.jsx)(u.A,{color:"processing",children:e.name},e.name))}):""},{title:"Duration",dataIndex:"duration",key:"duration",render:e=>e?(0,n.TT)(e):"",sorter:(e,t)=>e.duration-t.duration,sortDirections:["descend","ascend"]}];return(0,r.jsx)(x.A,{pagination:{hideOnSinglePage:!0},rowKey:"uuid",columns:w,dataSource:s,expandable:{expandedRowRender:e=>e.result_detail?(0,r.jsx)(y.A,{language:"python",children:JSON.parse(e.result_detail).join("\n\n")}):(0,r.jsx)(r.Fragment,{}),rowExpandable:e=>null!==e.result_detail}})}}},e=>{var t=t=>e(e.s=t);e.O(0,[369,290,592,10,714,636,593,792],()=>t(49272)),_N_E=e.O()}]);