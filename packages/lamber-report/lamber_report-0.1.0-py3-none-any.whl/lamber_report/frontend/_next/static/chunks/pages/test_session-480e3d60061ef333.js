(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[153],{3370:(e,t,s)=>{"use strict";function r(e){return e>1?"s":""}function n(e){let t="",s=Math.floor(e),n=Math.floor(s/31536e3);n&&(t+=n+" year"+r(n));let i=Math.floor((s%=31536e3)/86400);i&&(t+=" "+i+" day"+r(i));let a=Math.floor((s%=86400)/3600);a&&(t+=" "+a+" hour"+r(a));let o=Math.floor((s%=3600)/60);o&&(t+=" "+o+" min"+r(o));let l=s%60;return l&&(t+=" "+l+" sec"+r(l)),t||(t="< 1 sec"),t}function i(e){return e<0||e>0xffffffff?null:"".concat(e>>>24&255,".").concat(e>>>16&255,".").concat(e>>>8&255,".").concat(255&e)}function a(e){switch(e){case"PASS":return"#52c41a";case"FAIL":return"#f5222d";case"ERROR":return"#ff4d4f";case"XPASS":return"#faad14";case"XFAIL":return"#13c2c2";case"ABORT":return"#eb2f96";default:return"#bfbfbf"}}s.d(t,{TT:()=>n,bK:()=>i,dy:()=>a})},4374:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/test_session",function(){return s(46797)}])},46797:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>F});var r=s(5640),n=s(77583),i=s(87057),a=s.n(i),o=s(40838),l=s(24671),c=s(11149),d=s(41488),u=s(58679),x=s(81386),h=s(30983);function j(e){let{testSessionId:t}=e,{testSessionEnvironment:s,isLoading:n}=(0,u.hO)(t);if(n)return(0,r.jsx)("div",{children:"Loading..."});let i=[];return s.environment&&Object.entries(JSON.parse(s.environment)).forEach(e=>{let[t,s]=e;i.push({key:t,label:t,children:s})}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{orientation:"left",children:"Environment"}),(0,r.jsx)(h.A,{items:i,styles:{content:{textAlign:"left"}},bordered:!0})]})}var f=s(3370),p=s(85339),m=s(35745),A=s(20659),g=s(5562),S=s(46373),y=s(25551),_=s(29832),v=s(249),w=s(66489);let{Text:E}=m.A;function I(e){let{testSessionId:t}=e,{testSessionResultStatistic:s,isLoading:n}=(0,u.HX)(t);if(n)return(0,r.jsx)("div",{children:"Loading..."});let i=0,a=0;s.statistics.map(e=>{0==a&&null===e.result&&(a=e.count),i+=e.count});let o=s.duration?(0,r.jsx)(p.A,{twoToneColor:(0,f.dy)("PASS")}):(0,r.jsx)(A.A,{size:"small"}),l=s.duration?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(E,{children:["Executed ",(0,r.jsx)(E,{strong:!0,children:i})," testcases, starting on"," ",(0,r.jsx)(E,{underline:!0,italic:!0,strong:!0,children:new Date(1e3*s.start_time).toLocaleString("zh-CN")})," ","and ending on"," ",(0,r.jsx)(E,{underline:!0,italic:!0,strong:!0,children:new Date(1e3*s.stop_time).toLocaleString("zh-CN")}),", with a time of"," ",(0,r.jsx)(E,{underline:!0,italic:!0,strong:!0,children:(0,f.TT)(s.duration)}),"."]})}):(0,r.jsxs)(E,{children:["Executing ",(0,r.jsx)(E,{strong:!0,children:i})," testcases, starting on"," ",(0,r.jsx)(E,{underline:!0,italic:!0,strong:!0,children:new Date(1e3*s.start_time).toLocaleString("zh-CN")}),", has spent"," ",(0,r.jsx)(E,{underline:!0,italic:!0,strong:!0,children:(0,f.TT)(Date.now()/1e3-s.start_time)}),"."]}),c=s.duration&&a?(0,r.jsxs)(E,{mark:!0,children:["Aborted ",(0,r.jsx)(E,{strong:!0,children:a})," testcases."]}):(0,r.jsx)(r.Fragment,{}),d=a?(0,r.jsx)(g.A,{percent:(i-a)/i*100}):(0,r.jsx)(r.Fragment,{});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{orientation:"left",children:"Statistic"}),(0,r.jsxs)(S.A,{direction:"vertical",style:{display:"flex"},children:[(0,r.jsxs)(S.A,{style:{display:"flex"},children:[o,l,c]}),d,(0,r.jsx)(y.A,{gutter:{xs:8,sm:16,md:24,lg:32},children:s.statistics.map(e=>(0,r.jsx)(_.A,{span:3,children:(0,r.jsx)(v.A,{children:(0,r.jsx)(w.A,{title:"".concat(e.result?e.result:"TODO","(").concat(e.count,")"),value:e.count/i*100,precision:2,valueStyle:{color:(0,f.dy)(e.result)},suffix:"%"})})},e.result))})]})]})}var T=s(96629);function k(e){let{testSessionId:t,projectName:s,projectId:n}=e,{testSessionTestcases:i,isLoading:a}=(0,u.FG)(t);return a?(0,r.jsx)("div",{children:"Loading..."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{orientation:"left",children:"Testcases"}),(0,r.jsx)(T.A,{testSessionId:t,testSessionTestcases:i,projectName:s,projectId:n})]})}function F(){let e=(0,d.useRouter)(),t=e.query.projectId,s=e.query.projectName,i=e.query.testSessionId,u=e.query.testSessionStartTime;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{separator:">",items:[{title:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.A,{}),(0,r.jsx)(a(),{href:"/",children:"Home"})]})},{title:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.A,{}),(0,r.jsx)(a(),{href:{pathname:"/project",query:{projectId:t,projectName:s}},children:s})]})},{title:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.A,{}),(0,r.jsx)("span",{children:new Date(1e3*parseFloat(u)).toLocaleString("zh-CN")})]})}]}),(0,r.jsx)(j,{testSessionId:i}),(0,r.jsx)(I,{testSessionId:i}),(0,r.jsx)(k,{testSessionId:i,projectName:s,projectId:t})]})}},58679:(e,t,s)=>{"use strict";s.d(t,{FG:()=>c,HX:()=>l,Kc:()=>x,Rs:()=>a,YK:()=>i,eU:()=>h,fU:()=>u,hO:()=>o,iS:()=>j,zs:()=>d});var r=s(11572);let n=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return fetch(...t).then(e=>e.json())};function i(){let{data:e,error:t,isLoading:s}=(0,r.Ay)("/api/projects",n);return{projects:e,isLoading:s,isError:t}}function a(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/project/test_sessions?project_id=".concat(e),n);return{testSessions:t,isLoading:i,isError:s}}function o(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/test_session/environment?test_session_id=".concat(e),n);return{testSessionEnvironment:t,isLoading:i,isError:s}}function l(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/test_session/result_statistic?test_session_id=".concat(e),n);return{testSessionResultStatistic:t,isLoading:i,isError:s}}function c(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/test_session/testcases?test_session_id=".concat(e),n);return{testSessionTestcases:t,isLoading:i,isError:s}}function d(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/testcase/landing?testcase_id=".concat(e),n);return{testcaseLanding:t,isLoading:i,isError:s}}function u(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/testcase/explorer?testcase_id=".concat(e),n);return{testcaseExplorer:t,isLoading:i,isError:s}}function x(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/testcase/sourcecode?testcase_id=".concat(e),n);return{testresultSourcecode:t,isLoading:i,isError:s}}function h(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/testcase/histories?testcase_id=".concat(e),n);return{testSessionTestcases:t,isLoading:i,isError:s}}function j(e){let{data:t,error:s,isLoading:i}=(0,r.Ay)("/api/testcase/pytest_logs?testcase_id=".concat(e),n);return{testcasePytestLogs:t,isLoading:i,isError:s}}},96629:(e,t,s)=>{"use strict";s.d(t,{A:()=>g});var r=s(5640),n=s(3370),i=s(20844),a=s(44189),o=s(69491),l=s(78180),c=s(46373),d=s(6989),u=s(71415),x=s(32666),h=s(87057),j=s.n(h),f=s(50148),p=s(12921),m=s.n(p),A=s(27548);function g(e){let{testSessionId:t,testSessionTestcases:s,projectName:h,projectId:p}=e,[g,S]=(0,f.useState)(""),[y,_]=(0,f.useState)(""),v=(0,f.useRef)(null),w=(e,t,s)=>{t(),S(e[0]),_(s)},E=e=>{e(),S("")},I=e=>({filterDropdown:t=>{let{setSelectedKeys:s,selectedKeys:n,confirm:a,clearFilters:o,close:u}=t;return(0,r.jsxs)("div",{style:{padding:8},onKeyDown:e=>e.stopPropagation(),children:[(0,r.jsx)(l.A,{ref:v,placeholder:"Search ".concat(e),value:n[0],onChange:e=>s(e.target.value?[e.target.value]:[]),onPressEnter:()=>w(n,a,e),style:{marginBottom:8,display:"block"}}),(0,r.jsxs)(c.A,{children:[(0,r.jsx)(d.Ay,{type:"primary",onClick:()=>w(n,a,e),icon:(0,r.jsx)(i.A,{}),size:"small",style:{width:90},children:"Search"}),(0,r.jsx)(d.Ay,{onClick:()=>o&&E(o),size:"small",style:{width:90},children:"Reset"}),(0,r.jsx)(d.Ay,{type:"link",size:"small",onClick:()=>{a({closeDropdown:!1}),S(n[0]),_(e)},children:"Filter"}),(0,r.jsx)(d.Ay,{type:"link",size:"small",onClick:()=>{u()},children:"close"})]})]})},filterIcon:e=>(0,r.jsx)(i.A,{style:{color:e?"#1677ff":void 0}}),onFilter:(t,s)=>!!s&&!!s[e]&&s[e].toString().toLowerCase().includes(t.toLowerCase()),filterDropdownProps:{onOpenChange(e){e&&setTimeout(()=>{var e;return null==(e=v.current)?void 0:e.select()},100)}},render:t=>y===e?(0,r.jsx)(m(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[g],autoEscape:!0,textToHighlight:t?t.toString():""}):t}),T=[{title:"Result",dataIndex:"result",key:"result",render:(e,t)=>t.result?(0,r.jsx)(u.A,{color:(0,n.dy)(t.result),children:t.result}):t.start_time?(0,r.jsx)(a.A,{}):(0,r.jsx)(o.A,{}),filters:[{text:"PASS",value:"PASS"},{text:"FAIL",value:"FAIL"},{text:"ERROR",value:"ERROR"},{text:"XPASS",value:"XPASS"},{text:"XFAIL",value:"XFAIL"},{text:"ABORT",value:"ABORT"},{text:"SKIP",value:"SKIP"}],onFilter:(e,t)=>!!t.result&&0===t.result.indexOf(e),width:"8px"},{title:"Start Time",dataIndex:"start_time",key:"start_time",render:(e,s)=>s.start_time?(0,r.jsx)(j(),{href:{pathname:"/testcase",query:{projectId:p,projectName:h,testSessionId:t,testSessionStartTime:s.start_time.toString(),testcaseId:s.uuid,testcaseNodeid:s.nodeid}},children:new Date(1e3*s.start_time).toLocaleString("zh-CN")}):"",sorter:(e,t)=>e.start_time-t.start_time,sortDirections:["descend","ascend"],width:"220px"},{title:"Name",dataIndex:"nodeid",key:"nodeid",...I("nodeid")},{title:"Marker",dataIndex:"marker",key:"marker",...I("marker"),render:e=>e?(0,r.jsx)(c.A,{children:JSON.parse(e).map(e=>"parametrize"==e.name?"":(0,r.jsx)(u.A,{color:"processing",children:e.name},e.name))}):""},{title:"Duration",dataIndex:"duration",key:"duration",render:e=>e?(0,n.TT)(e):"",sorter:(e,t)=>e.duration-t.duration,sortDirections:["descend","ascend"]}];return(0,r.jsx)(x.A,{pagination:{hideOnSinglePage:!0},rowKey:"uuid",columns:T,dataSource:s,expandable:{expandedRowRender:e=>e.result_detail?(0,r.jsx)(A.A,{language:"python",children:JSON.parse(e.result_detail).join("\n\n")}):(0,r.jsx)(r.Fragment,{}),rowExpandable:e=>null!==e.result_detail}})}}},e=>{var t=t=>e(e.s=t);e.O(0,[369,290,592,10,293,636,593,792],()=>t(4374)),_N_E=e.O()}]);