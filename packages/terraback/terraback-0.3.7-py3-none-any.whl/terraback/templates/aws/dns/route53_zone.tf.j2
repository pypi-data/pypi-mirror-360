{% for zone in resources -%}
resource "aws_route53_zone" "zone_{{ zone.name_sanitized }}" {
  name    = "{{ zone.Name }}"
  comment = "{{ zone.Config.Comment | default('') }}"

  {%  if zone.Config.PrivateZone %}
  {%- for vpc in zone.VPCs %}
  vpc {
    vpc_id     = "{{ vpc.VPCId }}"
    vpc_region = "{{ vpc.VPCRegion }}"
  }
  {%- endfor %}
  {%  endif -%}

  {%  if zone.get('DelegationSetId') %}
  delegation_set_id = "{{ zone.DelegationSetId }}"
  {%  endif -%}

  {%  if zone.get('Tags') %}
  tags = {
    {%- for tag in zone.get('Tags', []) %}
    "{{ tag.Key }}" = "{{ tag.Value }}"{{ "," if not loop.last }}
    {%- endfor %}
  }
  {%  endif -%}

  lifecycle {
    prevent_destroy = true
  }
}

{% if not loop.last %}

{% endif -%}
{%- endfor %}