Metadata-Version: 2.4
Name: mcp-for-odps
Version: 0.1.3
Summary: MaxCompute (ODPS) MCP Server for getting table information and DDL
Project-URL: Homepage, https://github.com/TracyRay-cxr/mcp_for_odps
Project-URL: Repository, https://github.com/TracyRay-cxr/mcp_for_odps
Project-URL: Documentation, https://github.com/TracyRay-cxr/mcp_for_odps#readme
Project-URL: Issues, https://github.com/TracyRay-cxr/mcp_for_odps/issues
Author-email: tracy_ray <846206245@qq.com>
Maintainer-email: bigjunhong <chenjunhong0301@outlook.com>
License: MIT
License-File: LICENSE
Keywords: aliyun,data,maxcompute,mcp,odps
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.13
Classifier: Topic :: Database
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.13
Requires-Dist: httpx>=0.28.1
Requires-Dist: mcp[cli]>=1.10.1
Description-Content-Type: text/markdown

# MCP for ODPS

MaxCompute (ODPS) APIå·¥å…·ï¼Œç”¨äºè·å–è¡¨çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨åã€å­—æ®µä¿¡æ¯ã€åˆ†åŒºä¿¡æ¯å’ŒDDLã€‚

## ç¯å¢ƒå˜é‡é…ç½®

åœ¨ä½¿ç”¨æœ¬å·¥å…·ä¹‹å‰ï¼Œè¯·é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

### å¿…éœ€çš„ç¯å¢ƒå˜é‡

- `MAXCOMPUTE_PROJECT_NAME`: MaxComputeé¡¹ç›®åç§°

### å¯é€‰çš„ç¯å¢ƒå˜é‡

- `MAXCOMPUTE_SCHEMA_NAME`: Schemaåç§°ï¼ˆé»˜è®¤å€¼ï¼š`default`ï¼‰
- `MAXCOMPUTE_BASE_URL`: MaxCompute APIåŸºç¡€URLï¼ˆé»˜è®¤å€¼ï¼š`https://maxcompute.cn-hangzhou.aliyuncs.com`ï¼‰

### OAuthè®¤è¯ç¯å¢ƒå˜é‡ï¼ˆå¦‚æœéœ€è¦OAuthè®¤è¯ï¼‰

- `OAUTH_CLIENT_ID`: OAuthå®¢æˆ·ç«¯ID
- `OAUTH_CLIENT_SECRET`: OAuthå®¢æˆ·ç«¯å¯†é’¥
- `OAUTH_REDIRECT_URI`: OAuthé‡å®šå‘URI
- `OAUTH_SCOPE`: OAuthæˆæƒèŒƒå›´ï¼ˆé»˜è®¤å€¼ï¼š`odps.readonly`ï¼‰

### é…ç½®ç¤ºä¾‹

```bash
# åœ¨ .env æ–‡ä»¶ä¸­é…ç½®
MAXCOMPUTE_PROJECT_NAME=your_project_name
MAXCOMPUTE_SCHEMA_NAME=default
MAXCOMPUTE_BASE_URL=https://maxcompute.cn-hangzhou.aliyuncs.com

# OAuthè®¤è¯é…ç½®ï¼ˆå¯é€‰ï¼‰
OAUTH_CLIENT_ID=your_oauth_client_id
OAUTH_CLIENT_SECRET=your_oauth_client_secret
OAUTH_REDIRECT_URI=your_redirect_uri
OAUTH_SCOPE=odps.readonly
```

æˆ–è€…åœ¨å‘½ä»¤è¡Œä¸­è®¾ç½®ï¼š

```bash
export MAXCOMPUTE_PROJECT_NAME=your_project_name
export MAXCOMPUTE_SCHEMA_NAME=default
export MAXCOMPUTE_BASE_URL=https://maxcompute.cn-hangzhou.aliyuncs.com

# OAuthè®¤è¯é…ç½®ï¼ˆå¯é€‰ï¼‰
export OAUTH_CLIENT_ID=your_oauth_client_id
export OAUTH_CLIENT_SECRET=your_oauth_client_secret
export OAUTH_REDIRECT_URI=your_redirect_uri
export OAUTH_SCOPE=odps.readonly
```

## ä½¿ç”¨æ–¹æ³•

### è·å–è¡¨ä¿¡æ¯

```python
# ä½¿ç”¨å…¨å±€é…ç½®è·å–è¡¨ä¿¡æ¯
result = await get_table_info(['table1', 'table2'])
```

### APIåŠŸèƒ½

- **å¹¶å‘è¯·æ±‚**: æ”¯æŒåŒæ—¶è·å–å¤šä¸ªè¡¨çš„ä¿¡æ¯ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡
- **å®Œæ•´ä¿¡æ¯**: è¿”å›è¡¨çš„å®Œæ•´ä¿¡æ¯ï¼ŒåŒ…æ‹¬å­—æ®µã€åˆ†åŒºã€DDLç­‰
- **é”™è¯¯å¤„ç†**: è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œæ—¥å¿—è®°å½•
- **JSONæ ¼å¼**: è¿”å›ç»“æ„åŒ–çš„JSONæ•°æ®

### è¿”å›æ•°æ®æ ¼å¼

```json
{
  "success": [
    {
      "tableName": "è¡¨å",
      "projectName": "é¡¹ç›®å",
      "schema": "schemaå",
      "owner": "æ‰€æœ‰è€…",
      "type": "è¡¨ç±»å‹",
      "creationTime": "åˆ›å»ºæ—¶é—´",
      "lastModifiedTime": "æœ€åä¿®æ”¹æ—¶é—´",
      "lifecycle": "ç”Ÿå‘½å‘¨æœŸ",
      "comment": "è¡¨æ³¨é‡Š",
      "createTableDDL": "å»ºè¡¨DDL",
      "columns": [
        {
          "name": "å­—æ®µå",
          "type": "å­—æ®µç±»å‹",
          "comment": "å­—æ®µæ³¨é‡Š",
          "isNullable": true
        }
      ],
      "partitionColumns": [
        {
          "name": "åˆ†åŒºå­—æ®µå",
          "type": "åˆ†åŒºå­—æ®µç±»å‹",
          "comment": "åˆ†åŒºå­—æ®µæ³¨é‡Š",
          "isNullable": false
        }
      ]
    }
  ],
  "failed": [
    {
      "tableName": "å¤±è´¥çš„è¡¨å",
      "error": "é”™è¯¯ä¿¡æ¯"
    }
  ]
}
```

## ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„é›†æˆæµ‹è¯•å®¢æˆ·ç«¯ï¼Œç”¨äºéªŒè¯æ‰€æœ‰åŠŸèƒ½ï¼š

### è¿è¡Œæµ‹è¯•

```bash
# è¿›å…¥æµ‹è¯•å®¢æˆ·ç«¯ç›®å½•
cd client

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python run_test.py
```

### æµ‹è¯•å†…å®¹
- âœ… **get_table_info** å·¥å…·åŠŸèƒ½æµ‹è¯•
- âœ… **execute_sql** å·¥å…·åŠŸèƒ½æµ‹è¯•ï¼ˆå¼€å‘ä¸­ï¼‰
- âœ… **OAuthç¯å¢ƒå˜é‡** é…ç½®æµ‹è¯•
- âœ… **MCPè¿æ¥** å’Œé€šä¿¡æµ‹è¯•

æµ‹è¯•å®¢æˆ·ç«¯ä½¿ç”¨Mockæ•°æ®ï¼Œæ— éœ€çœŸå®çš„MaxComputeç¯å¢ƒå³å¯å®ŒæˆåŠŸèƒ½éªŒè¯ã€‚è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [`client/README.md`](client/README.md)ã€‚

## å¼€å‘

### é¡¹ç›®ç»“æ„

```
mcp_for_odps/
â”œâ”€â”€ application.py          # MCPå·¥å…·ä¸»æ–‡ä»¶
â”œâ”€â”€ component/
â”‚   â”œâ”€â”€ __init__.py        # ç»„ä»¶å¯¼å‡º
â”‚   â”œâ”€â”€ token_manager.py   # OAuthè®¤è¯ç®¡ç†
â”‚   â””â”€â”€ get_table_info.py  # è¡¨ä¿¡æ¯è·å–API
â”œâ”€â”€ client/                 # æµ‹è¯•å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ mcp_client.py      # ä¸»æµ‹è¯•å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ run_test.py        # æµ‹è¯•è¿è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ config.json        # Mockæ•°æ®é…ç½®
â”‚   â”œâ”€â”€ test_config.env    # æµ‹è¯•ç¯å¢ƒå˜é‡
â”‚   â””â”€â”€ README.md          # æµ‹è¯•è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ main.py
â”œâ”€â”€ pyproject.toml
â””â”€â”€ README.md
```

### ä¾èµ–

- `httpx`: HTTPå®¢æˆ·ç«¯
- `mcp[cli]`: MCPæ¡†æ¶
- `openai`: OpenAIå®¢æˆ·ç«¯

## æ³¨æ„äº‹é¡¹

1. ç¡®ä¿è®¾ç½®äº†æ­£ç¡®çš„ç¯å¢ƒå˜é‡
2. MaxComputeé¡¹ç›®éœ€è¦æœ‰ç›¸åº”çš„è®¿é—®æƒé™
3. ç½‘ç»œç¯å¢ƒéœ€è¦èƒ½å¤Ÿè®¿é—®MaxCompute API
4. å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨é€‚å½“çš„æ—¥å¿—çº§åˆ«
