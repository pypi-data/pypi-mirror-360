import { $APP, shadow$provide, $jscomp } from "./common.js";
var rI=function(){var a=$APP.Rm(1);$APP.vm(function(){var b=function(){function d(e){var f=e[1];if(f===7){var g=e[7];f=$APP.u(mI);f=!$APP.Vd(f,g);e[8]=f;e[1]=f?10:11;return $APP.Nm}if(f===1)return f=$APP.u(nI),f=$APP.Ih(f),g=$APP.D(f),e[9]=g,e[2]=null,e[1]=2,$APP.Nm;if(f===4){g=e[9];g=$APP.E(g);f=$APP.jw.g(g);g=$APP.Gf(g,new $APP.V(null,2,5,$APP.W,[$APP.qw,$APP.Fy],null));var k=$APP.u(oI),n=$APP.si.g(g);f=$APP.Gf(k,new $APP.V(null,4,5,$APP.W,[f,$APP.Rv,n,$APP.gz],null));e[7]=g;e[10]=f;e[1]=$APP.m(g)?
7:8;return $APP.Nm}return f===15?(e[2]=e[2],e[1]=6,$APP.Nm):f===13?(g=e[7],f=$APP.Z.s(pI,$APP.Y,g,$APP.Lg),g=$APP.fn(qI,g,$APP.Tl(pI,new $APP.V(null,1,5,$APP.W,[g],null))),k=$APP.Z.s(mI,$APP.Y,g.group,g.cache),n=g.fc,e[12]=f,e[11]=g,e[13]=k,$APP.Om(e,16,n)):f===6?(e[2]=e[2],e[1]=3,$APP.Nm):f===3?$APP.Pm(e,e[2]):f===12?(e[2]=e[2],e[1]=9,$APP.Nm):f===2?(g=e[9],f=$APP.D(g),e[1]=f?4:5,$APP.Nm):f===11?(f=e[8],e[2]=f,e[1]=12,$APP.Nm):f===9?(e[1]=$APP.m(e[2])?13:14,$APP.Nm):f===5?(e[2]=null,e[1]=6,$APP.Nm):
f===14?(g=e[9],g=$APP.G(g),e[9]=g,e[2]=null,e[1]=2,$APP.Nm):f===16?(g=e[9],k=e[11],f=e[2],g=$APP.G(g),k=$APP.u(k),k=$APP.Ih(k),k=$APP.D(k),g=$APP.Cf.h(g,k),e[14]=f,e[9]=g,e[2]=null,e[1]=2,$APP.Nm):f===10?(f=e[10],f=$APP.K.h(f,"schematic"),e[2]=f,e[1]=12,$APP.Nm):f===8?(g=e[7],e[2]=g,e[1]=9,$APP.Nm):null}return function(){function e(k){for(;;){a:{try{for(;;){var n=d(k);if(!$APP.R(n,$APP.Nm)){var p=n;break a}}}catch(q){p=q;k[2]=p;if($APP.D(k[4]))k[1]=$APP.E(k[4]);else throw p;p=$APP.Nm;break a}p=void 0}if(!$APP.R(p,
$APP.Nm))return p}}function f(){var k=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];k[0]=g;k[1]=1;return k}var g=null;g=function(k){switch(arguments.length){case 0:return f.call(this);case 1:return e.call(this,k)}throw Error("Invalid arity: "+arguments.length);};g.o=f;g.g=e;return g}()}(),c=function(){var d=b();d[6]=a;return d}();return $APP.Mm(c)})},sI=new $APP.Q("nyancad.mosaic.anywidget","anywidget-sync","nyancad.mosaic.anywidget/anywidget-sync",-1693447253);var tI=new URLSearchParams(window.location.search),uI,vI=tI.get("schem");uI=$APP.m(vI)?vI:"myschem";var wI=tI.get("db"),qI=new $APP.vz($APP.m(wI)?wI:"schematics"),pI=$APP.Sl($APP.Ze([uI,$APP.S,"models",$APP.S])),nI=$APP.fn(qI,uI,$APP.Tl(pI,new $APP.V(null,1,5,$APP.W,[uI],null))),oI=$APP.fn(qI,"models",$APP.Tl(pI,new $APP.V(null,1,5,$APP.W,["models"],null))),xI=$APP.fn(qI,[$APP.r.g(uI),"$result"].join(""),$APP.Sl($APP.Eh())),mI=$APP.dn(qI,$APP.N([nI,oI,xI]));export const render=function(a){var b=a.model;a.el.innerHTML="Connected to editor.";b.set("schematic_data",$APP.zl($APP.u(pI)));b.set("name",uI);b.save_changes();$APP.Gi(pI,sI,function(c,d,e,f){$APP.Bi($APP.N(["Schematic updated, syncing to anywidget model"]));rI();b.set("schematic_data",$APP.zl(f));return b.save_changes()});b.on("change:simulation_data",function(){var c=$APP.Qi(b.get("simulation_data")),d=(new Date).toISOString();d=[$APP.r.g(uI),"$result:",$APP.r.g(d)].join("");$APP.Bi($APP.N(["Received simulation data from Python, storing with key:",
d]));return $APP.Z.s(xI,$APP.Y,d,c)});return null};