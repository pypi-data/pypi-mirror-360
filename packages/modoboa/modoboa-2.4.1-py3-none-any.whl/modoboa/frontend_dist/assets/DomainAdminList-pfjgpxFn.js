import{l as z,b as L,g as v,d as U,c as r,o as l,w as e,a as o,e as $,j as y,t as s,f as u,n as _,k as m,L as E}from"./index-6uM3C9QJ.js";import{d as h}from"./domains-vJA4hvK9.js";import{V as G,a as H,b as I,c as O}from"./VCard-UdW0_Uwo.js";import{V as q}from"./VDataTableVirtual-BiuTZdvy.js";import{V as A,d as C}from"./index-BTn2TCUq.js";import{V as F}from"./VAutocomplete-CmWiskVY.js";import{V as J,a as D}from"./VRow-B8i6Vivu.js";const K={class:"headline"},P={key:0,class:"headline"},Q={key:1,class:"headline"},W={key:0},oe={__name:"DomainAdminList",props:{domain:{type:Object,default:()=>{}},dialogMode:{type:Boolean,default:!1}},emits:["close"],setup(c,{emit:N}){const x=z(),{$gettext:a}=L(),f=c,M=N,p=v([]),k=v([]),w=v([{title:a("Username"),value:"username"},{title:a("Name"),value:"name"},{title:"",value:"actions",align:"end",sortable:!1}]),V=v(!1),d=v(null);function S(){k.value.push({}),V.value=!0}function T(){V.value=!1,M("close")}function g(n){h.getDomainAdministrators(n.pk).then(t=>{k.value=t.data})}function b(){E.getAll({role:"DomainAdmins"}).then(n=>{p.value=n.data.filter(t=>k.value.find(i=>i.id===t.pk)===void 0)})}function j(){h.addDomainAdministrator(f.domain.pk,d.value.pk).then(()=>{g(f.domain),p.value=p.value.filter(n=>n.pk!==d.value.pk),d.value=null,V.value=!1,x.displayNotification({msg:a("Administrator added")})})}function R(n){h.removeDomainAdministrator(f.domain.pk,n.id).then(()=>{g(f.domain),b(),x.displayNotification({msg:a("Administrator removed")})})}return U(()=>{g(f.domain),b()}),(n,t)=>(l(),r(O,null,{default:e(()=>[o(G,null,{default:e(()=>[$("span",K,[c.dialogMode?(l(),y("div",P,s(u(a)("Administrators of"))+" "+s(c.domain.name),1)):(l(),y("div",Q,s(u(a)("Administrators")),1))])]),_:1}),o(H,null,{default:e(()=>[o(q,{headers:w.value,items:k.value},{"item.username":e(({item:i})=>[i.id?(l(),y("span",W,s(i.username),1)):(l(),r(F,{key:1,modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=B=>d.value=B),label:u(a)("Select an account"),items:p.value,variant:"outlined","item-title":"username",class:"mt-5","return-object":""},{append:e(()=>[d.value?(l(),r(A,{key:0,variant:"text",color:"primary",size:"x-large",onClick:j},{default:e(()=>[o(C,null,{default:e(()=>t[1]||(t[1]=[m("mdi-content-save")])),_:1,__:[1]})]),_:1})):_("",!0)]),_:1},8,["modelValue","label","items"]))]),"item.name":e(({item:i})=>[m(s(i.first_name)+" "+s(i.last_name),1)]),"item.actions":e(({item:i})=>[i.id?(l(),r(A,{key:0,variant:"text",color:"red",title:u(a)("Remove this administrator"),size:"x-large",onClick:B=>R(i)},{default:e(()=>[o(C,null,{default:e(()=>t[2]||(t[2]=[m("mdi-delete-outline")])),_:1,__:[2]})]),_:2},1032,["title","onClick"])):_("",!0)]),_:2},1032,["headers","items"])]),_:1}),o(I,null,{default:e(()=>[o(J,null,{default:e(()=>[o(D,{align:c.dialogMode?"left":"right"},{default:e(()=>[V.value?_("",!0):(l(),r(A,{key:0,color:"primary",variant:"outlined",onClick:S},{default:e(()=>[o(C,{small:""},{default:e(()=>t[3]||(t[3]=[m("mdi-plus")])),_:1,__:[3]}),m(" "+s(u(a)("Add administrator")),1)]),_:1}))]),_:1},8,["align"]),c.dialogMode?(l(),r(D,{key:0,align:"right"},{default:e(()=>[o(A,{color:"grey darken-1",variant:"text",onClick:T},{default:e(()=>[m(s(u(a)("Close")),1)]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1})]),_:1}))}};export{oe as _};
