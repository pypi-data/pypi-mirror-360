import{C as j}from"./ChoiceField-BE5A2NOX.js";import{u as L,b as R,g as _,h as f,c as A,o as h,w as V,a as d,f as s,e as F,t as x,k as q,i as M,J as B,n as N,j as Q,F as I,D as T,L as G}from"./index-6uM3C9QJ.js";import{V as H,a as D}from"./VRow-B8i6Vivu.js";import{V as C}from"./VAlert-B27KCrh1.js";import{d as z}from"./index-BTn2TCUq.js";import{V as k,r as U}from"./VForm-BM98r94C.js";import{_ as J}from"./AccountPasswordSubForm-lQIx0VeZ.js";import{E}from"./EmailField-DoOHEhV4.js";import{V as S}from"./VTextField-DI1vrMFe.js";import{V as $}from"./VSwitch-CS2VqXpn.js";import{u as K}from"./domains.store-BRdtIDtL.js";import{V as P}from"./VChip-DH7R5Ijd.js";const Y={class:"headline"},W={class:"mt-4"},be={__name:"AccountRoleForm",props:{modelValue:{type:Object,default:null}},setup(y,{expose:w}){const i=L(),{$gettext:a}=R(),v=y,m=_(),c=f(()=>v.modelValue),l=f(()=>i.authUser),p=f(()=>{const r=b.value.find(n=>n.value===c.value.role);return r!==void 0?r.label:""}),e=f(()=>{const r=b.value.find(n=>n.value===c.value.role);return r!==void 0?r.help:""}),b=f(()=>l.value.role==="SuperAdmins"?[...o,...u,...g,...t]:l.value.role==="DomainAdmins"?[...g]:l.value.role==="Resellers"?[...o,...g]:[]),g=[{label:a("Simple user"),value:"SimpleUsers",help:a("A user with no privileges but with a mailbox. He will be allowed to use all end-user features: webmail, calendar, contacts, filters.")}],o=[{label:a("Domain administrator"),value:"DomainAdmins",help:a("A user with privileges on one or more domain. He will be allowed to administer mailboxes and he can also have a mailbox.")}],u=[{label:a("Reseller"),value:"Resellers",help:a("help")}],t=[{label:a("Super administrator"),value:"SuperAdmins",help:a("A user with all privileges, can do anything. By default, such a user does not have a mailbox so he can't access end-user features.")}];return w({vFormRef:m,roleLabel:p}),(r,n)=>(h(),A(k,{ref_key:"vFormRef",ref:m},{default:V(()=>[d(H,null,{default:V(()=>[d(D,{cols:"7"},{default:V(()=>[d(s(j),{modelValue:c.value.role,"onUpdate:modelValue":n[0]||(n[0]=O=>c.value.role=O),label:s(a)("Choose a role"),choices:b.value,"choices-per-line":2},null,8,["modelValue","label","choices"])]),_:1}),d(D,{cols:"5"},{default:V(()=>[d(C,{color:"primary",class:"mt-11 ml-4 rounded-lg"},{default:V(()=>[F("h3",Y,x(p.value),1),F("p",W,x(e.value),1),d(z,{color:"white",class:"float-right",size:"large",icon:"mdi-help-circle-outline"})]),_:1})]),_:1})]),_:1})]),_:1},512))}},X={class:"m-label"},Z={class:"m-label"},ee={class:"m-label"},_e={__name:"AccountGeneralForm",props:{modelValue:{type:Object,default:null},editing:{type:Boolean,default:!1}},setup(y,{expose:w}){const{$gettext:i}=R(),a=L(),v=y,m=_(),c=_({}),l=f(()=>v.modelValue),p=f(()=>l.value.role==="SimpleUsers"?i("Enter an email address"):i("Enter a simple username or an email address")),e=f(()=>l.value.role==="SimpleUsers"?"email":"text");function b(){l.value.role!="SuperAdmins"&&l.value.username.indexOf("@")!==-1&&(l.value.mailbox.full_address=l.value.username,l.value.mailbox.message_limit=null)}return w({vFormRef:m,formErrors:c}),(g,o)=>(h(),A(k,{ref_key:"vFormRef",ref:m},{default:V(()=>[F("label",X,x(s(i)("Username")),1),d(E,{ref:"username",modelValue:l.value.username,"onUpdate:modelValue":[o[0]||(o[0]=u=>l.value.username=u),b],placeholder:p.value,type:e.value,rules:e.value==="email"?[s(U).required,s(U).email]:[s(U).required],role:l.value.role,"error-msg":c.value.value?c.value.value.username:[]},null,8,["modelValue","placeholder","type","rules","role","error-msg"]),F("label",Z,x(s(i)("First name")),1),d(S,{modelValue:l.value.first_name,"onUpdate:modelValue":o[1]||(o[1]=u=>l.value.first_name=u),autocomplete:"new-password",variant:"outlined",density:"compact"},null,8,["modelValue"]),F("label",ee,x(s(i)("Last name")),1),d(S,{modelValue:l.value.last_name,"onUpdate:modelValue":o[2]||(o[2]=u=>l.value.last_name=u),autocomplete:"new-password",variant:"outlined",density:"compact"},null,8,["modelValue"]),s(a).authUser.pk!==l.value.pk?(h(),A(J,{key:0,ref:"passwordForm",modelValue:l.value,"onUpdate:modelValue":o[3]||(o[3]=u=>l.value=u),editing:y.editing,"form-errors":c.value},null,8,["modelValue","editing","form-errors"])):(h(),A(C,{key:1,type:"info",variant:"tonal",class:"py-2"},{default:V(()=>[q(x(s(i)("You can update your password from the Account section")),1)]),_:1})),d($,{modelValue:l.value.is_active,"onUpdate:modelValue":o[4]||(o[4]=u=>l.value.is_active=u),label:s(i)("Enabled"),density:"compact",color:"primary"},null,8,["modelValue","label"])]),_:1},512))}},le={class:"m-label"},ae={class:"m-label"},oe={__name:"AccountMailboxForm",props:{modelValue:{type:Object,default:null}},emits:["update:modelValue"],setup(y,{expose:w,emit:i}){const{$gettext:a}=R(),v=i,m=y,c=K(),l=f(()=>c.domains),p=_(),e=_({mailbox:{}});B(m.modelValue,t=>{t?(e.value={...t},e.value.role==="SimpleUsers"&&(e.value.mailbox||(e.value.mailbox={}),e.value.mailbox.full_address=e.value.username),e.value.mailbox.message_limit===""&&(e.value.mailbox.message_limit=null)):e.value={mailbox:{}}},{immediate:!0}),B(e,t=>{v("update:modelValue",t)},{deep:!0});const b=f(()=>{const t=e.value.mailbox.full_address;if(t&&t.indexOf("@")!==-1){const r=l.value.find(n=>n.name===t.split("@")[1]);if(r)return parseInt(r.default_mailbox_quota)}}),g=f(()=>{let t=a("Use domain default value");return b.value!==void 0&&(b.value===0?t+=` (${a("unlimited")})`:t+=` (${b.value} MB)`),t});function o(t){t&&delete e.value.mailbox.quota}function u(t){t===""&&(e.value.mailbox.message_limit=null)}return w({vFormRef:p}),(t,r)=>(h(),A(k,{ref_key:"vFormRef",ref:p},{default:V(()=>[F("label",le,x(s(a)("Quota")),1),d($,{modelValue:e.value.mailbox.use_domain_quota,"onUpdate:modelValue":[r[0]||(r[0]=n=>e.value.mailbox.use_domain_quota=n),o],label:g.value,color:"primary"},null,8,["modelValue","label"]),e.value.mailbox.use_domain_quota?N("",!0):(h(),A(S,{key:0,modelValue:e.value.mailbox.quota,"onUpdate:modelValue":r[1]||(r[1]=n=>e.value.mailbox.quota=n),placeholder:s(a)("Ex: 10MB. Leave empty for no limit"),hint:s(a)("Quota for this mailbox, can be expressed in KB, MB (default) or GB. Define a custom value or use domain's default one. Leave empty to define an unlimited value (not allowed for domain administrators)."),"persistent-hint":"",variant:"outlined",density:"compact"},null,8,["modelValue","placeholder","hint"])),F("label",ae,x(s(a)("Daily message sending limit")),1),d(S,{modelValue:e.value.mailbox.message_limit,"onUpdate:modelValue":[r[2]||(r[2]=n=>e.value.mailbox.message_limit=n),u],placeholder:s(a)("Leave empty for no limit"),hint:s(a)("Number of messages this mailbox can send per day. Leave empty for no limit."),"persistent-hint":"",variant:"outlined",density:"compact",rules:[s(U).numericOrNull]},null,8,["modelValue","placeholder","hint","rules"]),d($,{modelValue:e.value.mailbox.is_send_only,"onUpdate:modelValue":r[3]||(r[3]=n=>e.value.mailbox.is_send_only=n),label:s(a)("Send only account"),density:"compact",color:"primary"},null,8,["modelValue","label"])]),_:1},512))}},Ve=M(oe,[["__scopeId","data-v-bc1f210d"]]),xe={__name:"AccountAliasForm",props:{modelValue:{type:Object,default:null}},setup(y,{expose:w}){const{$gettext:i}=R(),a=y,v=f(()=>a.modelValue),m=_(""),c=_(),l=_(),p=_(!1),e=_([]);async function b(){if(e.value=[],p.value=!0,v.value.aliases.indexOf(m.value)!==-1){e.value=[i("Alias already added")],m.value="",p.value=!1;return}try{await G.validate({aliases:[m.value],mailbox:v.value.mailbox}),v.value.aliases.push(m.value),m.value="",l.value.resetValidation()}catch(o){o.response.data.aliases?o.response.data.aliases:o.response.data.non_field_errors&&o.response.data.non_field_errors}finally{p.value=!1}}function g(o){v.value.aliases.splice(o,1)}return w({vFormRef:l}),(o,u)=>(h(),A(k,{ref_key:"vFormRef",ref:l},{default:V(()=>[d(s(E),{ref_key:"aliasField",ref:c,modelValue:m.value,"onUpdate:modelValue":u[0]||(u[0]=t=>m.value=t),placeholder:s(i)("Start typing a name here..."),hint:s(i)("Alias(es) of this mailbox. To create a catchall alias, just enter the domain name (@domain.tld)."),"persistent-hint":"",loading:p.value,"error-msg":e.value,onDomainSelected:b},null,8,["modelValue","placeholder","hint","loading","error-msg"]),(h(!0),Q(I,null,T(v.value.aliases,(t,r)=>(h(),A(P,{key:r,class:"mr-2 mt-2",closable:"","onClick:close":n=>g(r)},{default:V(()=>[q(x(t),1)]),_:2},1032,["onClick:close"]))),128))]),_:1},512))}};export{Ve as A,xe as _,_e as a,be as b};
