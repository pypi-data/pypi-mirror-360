import{i as L,b,h as p,g as o,d as z,$ as F,a0 as B,a1 as T,j as g,o as v,a as y,n as U,z as N,a2 as W,w,F as D,D as j,c as G,G as K,k as O,t as P}from"./index-6uM3C9QJ.js";import{V as R}from"./VTextField-DI1vrMFe.js";import{a as q,b as H,V as J}from"./forwardRefs-DzkmOl4h.js";import{u as Q}from"./domains.store-BRdtIDtL.js";const X={__name:"EmailField",props:{modelValue:{type:String,default:""},allowAdd:{type:Boolean,default:!1},role:{type:String,default:"SimpleUsers"},errorMsg:{type:Array,default:()=>[]}},emits:["domain-selected","update:model-value"],setup(_,{emit:A}){const{$gettext:C}=b(),h=Q(),n=_,V=A,r=p({get(){return n.modelValue},set(e){u.value=[],e.indexOf("@")!==-1?n.role!=="SuperAdmins"?(i.value=e.split("@")[1],n.allowAdd?t.value=s.value.length>0:t.value=!0):u.value=[C("SuperAdmins cannot own a mailbox")]:t.value=!1,V("update:model-value",e)}}),s=p(()=>Object.values(h.domains).filter(e=>e.name.startsWith(i.value))),u=p({get(){return[...x.value,...n.errorMsg]},set(e){x.value=e}}),i=o(""),l=o(0),t=o(!1),S=o(500),k=o(),x=o([]);function E(e){if(n.role==="SuperAdmins")return;const a=e.keyCode;a===40||a===34?(t.value?M():(i.value="",t.value=!0),e.preventDefault()):a===38||a===33?(t.value?$():(i.value="",t.value=!0),e.preventDefault()):a===13||a===9?(s.value.length>0?c(s.value[l.value]):n.allowAdd&&c(),e.preventDefault()):a===27&&s.value.length>0&&(t.value=!1,e.preventDefault())}function M(){l.value>=s.value.length-1?l.value=0:l.value+=1}function $(){l.value<=0?l.value=s.value.length-1:l.value-=1}function c(e){e!==void 0&&(r.value=r.value.split("@")[0]+"@"+e.name),t.value=!1,V("domain-selected")}function m(){S.value=k.value.$el.clientWidth}return z(()=>{h.getDomains(),window.addEventListener("resize",m)}),F(()=>{window.removeEventListener("resize",m)}),B(()=>{T(()=>{m()})}),(e,a)=>(v(),g(D,null,[y(R,N({ref_key:"inputRef",ref:k,modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=d=>r.value=d),variant:"outlined"},e.$attrs,{"error-messages":u.value,error:u.value.length>0,density:"compact",autocomplete:"new-password",onKeydown:E}),null,16,["modelValue","error-messages","error"]),t.value?(v(),g("div",{key:0,class:"menu",style:W(`width: ${S.value}px;`)},[y(J,{class:"list"},{default:w(()=>[(v(!0),g(D,null,j(s.value,(d,f)=>(v(),G(q,{key:f,class:K(l.value===f?"bg-primary-lighten-1":""),onClick:I=>c(d),onMouseenter:I=>l.value=f},{default:w(()=>[y(H,null,{default:w(()=>[O(P(d.name),1)]),_:2},1024)]),_:2},1032,["class","onClick","onMouseenter"]))),128))]),_:1})],4)):U("",!0)],64))}},ae=L(X,[["__scopeId","data-v-f4a8114a"]]);export{ae as E};
