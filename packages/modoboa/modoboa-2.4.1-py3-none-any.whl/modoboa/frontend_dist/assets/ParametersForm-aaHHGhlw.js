import{i as C,b as P,l as S,h as E,g as v,J as x,j as u,a as m,w as i,F as f,D as y,o as s,c as d,G as N,k as I,t as h,n as j,e as z,f as D}from"./index-6uM3C9QJ.js";import{_ as G}from"./HtmlEditor-gMdSe1xC.js";import{V as L,a as O,b as W,c as $}from"./VTabs-CS5ESs-Z.js";import{V as A}from"./index-BTn2TCUq.js";import{V as H}from"./VContainer-6TaCDL-y.js";import{c as J,a as M}from"./VCard-UdW0_Uwo.js";import{V as q}from"./VSwitch-CS2VqXpn.js";import{V as K}from"./VSelect-C2sbdVot.js";import{V as Q}from"./VTextarea-CZcksjj6.js";import{V as R}from"./VTextField-DI1vrMFe.js";const X={key:0},Y={class:"m-label"},Z={__name:"ParametersForm",props:{app:{type:String,default:""},structure:{type:Array,default:null},values:{type:Object,default:null},saveFunction:{type:Function,default:null}},emits:["success"],setup(k,{emit:F}){const c=k,U=F,{$gettext:g}=P(),{displayNotification:_}=S(),b=E(()=>c.structure.filter(o=>w(o))),p=v(0),n=v({}),l=v({}),V=v([]);x(()=>c.values,o=>{o&&(l.value={...o})}),x(l,()=>{V.value=[]});function w(o){if(o.display==="")return!0;let r=!0;return o.display.split("&").forEach(a=>{let[e,t]=a.split("=");(t==="true"||t==="false")&&(t=!!t),r&=l.value[e]===t}),r}function T(o){return o.filter(r=>w(r))}async function B(){n.value={},V.value=[];try{await c.saveFunction(c.app,l.value),_({msg:g("Parameters updated")}),U("success",l.value)}catch(o){_({msg:g("Could not save parameters"),type:"error"}),n.value=o.response.data,Object.keys(n.value).forEach(r=>{for(let a=0;a<c.structure.length;a++)c.structure[a].parameters.filter(t=>t.name===r).length>0&&V.value.push(a)})}}return(o,r)=>(s(),u(f,null,[m(L,{modelValue:p.value,"onUpdate:modelValue":r[0]||(r[0]=a=>p.value=a),"bg-color":"white"},{default:i(()=>[(s(!0),u(f,null,y(b.value,(a,e)=>(s(),d(W,{key:e,color:"primary",class:N(V.value.includes(e)?"error_tab":"")},{default:i(()=>[I(h(a.label),1)]),_:2},1032,["class"]))),128))]),_:1},8,["modelValue"]),m(O,{modelValue:p.value,"onUpdate:modelValue":r[1]||(r[1]=a=>p.value=a)},{default:i(()=>[(s(!0),u(f,null,y(b.value,a=>(s(),d($,{key:a.label},{default:i(()=>[m(H,{fluid:"",class:"pa-0"},{default:i(()=>[m(J,null,{default:i(()=>[m(M,null,{default:i(()=>[(s(!0),u(f,null,y(T(a.parameters),e=>(s(),u("div",{key:e.name,class:"my-4"},[e.widget==="SeparatorField"?(s(),u("h2",X,h(e.label),1)):e.widget==="BooleanField"?(s(),u(f,{key:1},[e.widget==="BooleanField"?(s(),d(q,{key:0,modelValue:l.value[e.name],"onUpdate:modelValue":t=>l.value[e.name]=t,label:e.label,hint:e.help_text,error:n.value[e.name]!==void 0,color:"primary",density:"compact","error-messages":n.value[e.name],"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint","error","error-messages"])):j("",!0)],64)):(s(),u(f,{key:2},[z("label",Y,h(e.label),1),e.widget==="ChoiceField"?(s(),d(K,{key:0,modelValue:l.value[e.name],"onUpdate:modelValue":t=>l.value[e.name]=t,items:e.choices,"item-title":"text",hint:e.help_text,"persistent-hint":"",density:"compact",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items","hint"])):e.widget==="TextareaField"?(s(),d(Q,{key:1,modelValue:l.value[e.name],"onUpdate:modelValue":t=>l.value[e.name]=t,hint:e.help_text,"persistent-hint":"",error:n.value[e.name]!==void 0,"error-messages":n.value[e.name],type:e.widget==="PasswordField"?"password":"text",density:"compact",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","hint","error","error-messages","type"])):e.widget==="HTMLField"?(s(),d(D(G),{key:2,modelValue:l.value[e.name],"onUpdate:modelValue":t=>l.value[e.name]=t},null,8,["modelValue","onUpdate:modelValue"])):(s(),d(R,{key:3,modelValue:l.value[e.name],"onUpdate:modelValue":t=>l.value[e.name]=t,hint:e.help_text,"persistent-hint":"",error:n.value[e.name]!==void 0,"error-messages":n.value[e.name],type:e.widget==="PasswordField"?"password":"text",density:"compact",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","hint","error","error-messages","type"]))],64))]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"]),m(A,{icon:"mdi-content-save",class:"ma-5",position:"fixed",location:"bottom right",color:"green",size:"large",onClick:B})],64))}},de=C(Z,[["__scopeId","data-v-a4919ac7"]]);export{de as P};
