Metadata-Version: 2.4
Name: bio_knowledge_graph
Version: 1.1.0
Summary: A Chinese relation extraction data utility toolkit based on CasRel model
Home-page: https://github.com/yuyanhong/bio_knowledge_graph
Author: DT.L
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.7
Description-Content-Type: text/markdown
Requires-Dist: torch
Requires-Dist: transformers>=4.0.0
Dynamic: author
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# BIO çŸ¥è¯†å›¾è°±ç³»ç»Ÿ (æœ¬åœ°æ¨¡å‹ç‰ˆ)

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ BIO æ ‡æ³¨çŸ¥è¯†å›¾è°±ç³»ç»Ÿï¼Œä½¿ç”¨æœ¬åœ° multilingual-e5-base æ¨¡å‹ï¼Œæ•´åˆäº† Neo4jã€è¯­ä¹‰æ¨ç†ã€å‘é‡æ£€ç´¢ã€LLM è¾…åŠ©æ ‡æ³¨ç­‰å…ˆè¿›æŠ€æœ¯ã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **æ™ºèƒ½æ ‡æ³¨**: åŸºäºæœ¬åœ° multilingual-e5-base æ¨¡å‹çš„è‡ªåŠ¨ BIO æ ‡æ³¨
- **è¯­ä¹‰æ¨ç†**: å®ä½“æ¶ˆæ­§ã€å…³ç³»æ¨èã€æœ¬ä½“æ¨ç†
- **å‘é‡æ£€ç´¢**: åŸºäº FAISS çš„è¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢
- **çŸ¥è¯†å›¾è°±**: Neo4j é©±åŠ¨çš„å›¾æ•°æ®åº“å­˜å‚¨å’ŒæŸ¥è¯¢
- **å¯è§†åŒ–ç•Œé¢**: ç°ä»£åŒ–çš„ Web ç®¡ç†ç•Œé¢

### æŠ€æœ¯æ ˆ
- **åç«¯**: Flask + Python
- **æ•°æ®åº“**: Neo4j å›¾æ•°æ®åº“
- **å‘é‡æ¨¡å‹**: æœ¬åœ° multilingual-e5-base (768ç»´)
- **å‘é‡æ£€ç´¢**: FAISS + Sentence Transformers
- **LLM**: OpenAI GPT-3.5/4 API (å¯é€‰)
- **å‰ç«¯**: HTML5 + CSS3 + JavaScript + D3.js
- **å¯è§†åŒ–**: Vis.js ç½‘ç»œå›¾

## ğŸ“‹ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ç•Œé¢      â”‚    â”‚   API æœåŠ¡å±‚    â”‚    â”‚   æ•°æ®å­˜å‚¨å±‚    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ æ ‡æ³¨ç®¡ç†      â”‚â—„â”€â”€â–ºâ”‚ â€¢ æ ‡æ³¨æœåŠ¡      â”‚â—„â”€â”€â–ºâ”‚ â€¢ Neo4j å›¾åº“    â”‚
â”‚ â€¢ å›¾è°±å¯è§†åŒ–    â”‚    â”‚ â€¢ è¯­ä¹‰æœåŠ¡      â”‚    â”‚ â€¢ FAISS ç´¢å¼•    â”‚
â”‚ â€¢ è¯¾ç¨‹ç®¡ç†      â”‚    â”‚ â€¢ å‘é‡æœåŠ¡      â”‚    â”‚ â€¢ æœ¬åœ°æ¨¡å‹      â”‚
â”‚ â€¢ ç³»ç»Ÿç›‘æ§      â”‚    â”‚ â€¢ LLM æœåŠ¡      â”‚    â”‚ â€¢ æ–‡ä»¶å­˜å‚¨      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ å®‰è£…éƒ¨ç½²

### ç¯å¢ƒè¦æ±‚
- Python 3.8+
- Neo4j 4.0+
- 8GB+ RAM (æ¨è)
- æœ¬åœ° multilingual-e5-base æ¨¡å‹
- CUDA GPU (å¯é€‰ï¼Œç”¨äºåŠ é€Ÿå‘é‡è®¡ç®—)

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd bio_knowledge_graph_local_model
```

### 2. å‡†å¤‡æœ¬åœ°æ¨¡å‹

#### æ–¹æ³•ä¸€ï¼šä¸‹è½½é¢„è®­ç»ƒæ¨¡å‹
```bash
# åˆ›å»ºæ¨¡å‹ç›®å½•
mkdir -p models/multilingual-e5-base

# ä½¿ç”¨ Python ä¸‹è½½æ¨¡å‹
python3 -c "
from sentence_transformers import SentenceTransformer
model = SentenceTransformer('intfloat/multilingual-e5-base')
model.save('./models/multilingual-e5-base')
print('æ¨¡å‹ä¸‹è½½å®Œæˆ')
"
```

#### æ–¹æ³•äºŒï¼šä½¿ç”¨å·²æœ‰æ¨¡å‹
å¦‚æœæ‚¨å·²ç»æœ‰ multilingual-e5-base æ¨¡å‹ï¼Œè¯·å°†å…¶æ”¾ç½®åœ¨ `./models/multilingual-e5-base/` ç›®å½•ä¸‹ã€‚

### 3. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### 4. é…ç½®ç¯å¢ƒå˜é‡
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®æœ¬åœ°æ¨¡å‹è·¯å¾„å’Œå…¶ä»–è®¾ç½®
```

é‡è¦é…ç½®é¡¹ï¼š
```bash
# æœ¬åœ°æ¨¡å‹è·¯å¾„
LOCAL_MODEL_PATH=./models/multilingual-e5-base
VECTOR_DIMENSION=768

# æ¨¡å‹ç¼“å­˜ç›®å½•
HF_HOME=./models
TRANSFORMERS_CACHE=./models/transformers_cache
SENTENCE_TRANSFORMERS_HOME=./models/sentence_transformers
```

### 5. å¯åŠ¨ Neo4j æ•°æ®åº“
```bash
# ä½¿ç”¨ Docker å¯åŠ¨ Neo4j
docker run -d \
    --name neo4j \
    -p 7474:7474 -p 7687:7687 \
    -e NEO4J_AUTH=neo4j/biokg2024 \
    neo4j:latest
```

### 6. åˆå§‹åŒ–æ•°æ®åº“
```bash
python -c "from models.database import db; db.create_indexes()"
```

### 7. å¯åŠ¨åº”ç”¨
```bash
python run.py
```

### 8. è®¿é—®ç³»ç»Ÿ
- API æ–‡æ¡£: http://localhost:5000/api
- ç®¡ç†ç•Œé¢: http://localhost:5000
- Neo4j æµè§ˆå™¨: http://localhost:7474

## ğŸ“– ä½¿ç”¨æŒ‡å—

### æœ¬åœ°æ¨¡å‹é…ç½®

#### æ¨¡å‹è·¯å¾„è®¾ç½®
åœ¨ `.env` æ–‡ä»¶ä¸­è®¾ç½®æœ¬åœ°æ¨¡å‹è·¯å¾„ï¼š
```bash
LOCAL_MODEL_PATH=./models/multilingual-e5-base
```

#### æ¨¡å‹éªŒè¯
å¯åŠ¨åº”ç”¨åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ API æ£€æŸ¥æ¨¡å‹çŠ¶æ€ï¼š
```bash
curl http://localhost:5000/api/vector/health
```

### æ™ºèƒ½æ ‡æ³¨
1. åœ¨æ ‡æ³¨é¡µé¢è¾“å…¥éœ€è¦æ ‡æ³¨çš„æ–‡æœ¬
2. ç³»ç»Ÿå°†ä½¿ç”¨æœ¬åœ° multilingual-e5-base æ¨¡å‹è¿›è¡Œå‘é‡ç¼–ç 
3. ç»“åˆè¯­ä¹‰è§„åˆ™å’Œå‘é‡ç›¸ä¼¼åº¦è¿›è¡Œæ ‡æ³¨
4. æŸ¥çœ‹æ ‡æ³¨å®ä½“å’Œç½®ä¿¡åº¦
5. ä¿å­˜æ ‡æ³¨ç»“æœåˆ°çŸ¥è¯†å›¾è°±

### å‘é‡æ£€ç´¢
1. ä½¿ç”¨æœ¬åœ°æ¨¡å‹è¿›è¡Œè¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢
2. æ”¯æŒå®ä½“èšç±»å’Œç›¸ä¼¼åº¦è®¡ç®—
3. æ„å»ºå’Œç®¡ç† FAISS å‘é‡ç´¢å¼•
4. æ‰¹é‡å¤„ç†å’Œå¢é‡æ›´æ–°

## ğŸ”§ API æ–‡æ¡£

### å‘é‡æœåŠ¡ API

#### POST /api/vector/search
ä½¿ç”¨æœ¬åœ°æ¨¡å‹è¿›è¡Œè¯­ä¹‰æœç´¢

**è¯·æ±‚ä½“:**
```json
{
    "query": "éŸ³ä¹ç›¸å…³è¯¾ç¨‹",
    "k": 10,
    "threshold": 0.5
}
```

#### POST /api/vector/similarity
è®¡ç®—ä¸¤ä¸ªæ–‡æœ¬çš„è¯­ä¹‰ç›¸ä¼¼åº¦

**è¯·æ±‚ä½“:**
```json
{
    "text1": "é’¢ç´è¯¾ç¨‹",
    "text2": "éŸ³ä¹æ•™å­¦"
}
```

#### POST /api/vector/embedding
è·å–æ–‡æœ¬çš„å‘é‡è¡¨ç¤º

**è¯·æ±‚ä½“:**
```json
{
    "text": "æˆ‘å–œæ¬¢å­¦ä¹ é’¢ç´"
}
```

**å“åº”:**
```json
{
    "status": "success",
    "data": {
        "text": "æˆ‘å–œæ¬¢å­¦ä¹ é’¢ç´",
        "embedding": [0.1, 0.2, ...],
        "dimension": 768
    }
}
```

### æ ‡æ³¨ API

#### POST /api/annotate
æ™ºèƒ½æ ‡æ³¨æ–‡æœ¬ï¼ˆä½¿ç”¨æœ¬åœ°æ¨¡å‹ï¼‰

**è¯·æ±‚ä½“:**
```json
{
    "text": "æˆ‘å–œæ¬¢å­¦ä¹ é’¢ç´å’Œç»˜ç”»",
    "context": "å…´è¶£çˆ±å¥½æè¿°",
    "use_llm": false,
    "use_vector": true
}
```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œå•å…ƒæµ‹è¯•
```bash
pytest tests/
```

### æµ‹è¯•æœ¬åœ°æ¨¡å‹
```bash
python -c "
from services.vector_service import VectorService
service = VectorService('./models/multilingual-e5-base', 768)
success = service.load_model()
print(f'æ¨¡å‹åŠ è½½: {\"æˆåŠŸ\" if success else \"å¤±è´¥\"}')

if success:
    embedding = service.encode_text('æµ‹è¯•æ–‡æœ¬')
    print(f'å‘é‡ç»´åº¦: {len(embedding)}')
    print(f'å‘é‡ç¤ºä¾‹: {embedding[:5]}')
"
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### æœ¬åœ°æ¨¡å‹æ€§èƒ½
- **æ¨¡å‹å¤§å°**: ~1.1GB
- **å‘é‡ç»´åº¦**: 768
- **ç¼–ç é€Ÿåº¦**: 500-1000 å­—ç¬¦/ç§’ (CPU)
- **ç¼–ç é€Ÿåº¦**: 2000+ å­—ç¬¦/ç§’ (GPU)
- **å†…å­˜å ç”¨**: ~2GB (æ¨¡å‹åŠ è½½å)

### æ ‡æ³¨æ€§èƒ½
- **å‡†ç¡®ç‡**: 95%+
- **å¬å›ç‡**: 92%+
- **F1 åˆ†æ•°**: 93%+
- **å¤„ç†é€Ÿåº¦**: 800 å­—ç¬¦/ç§’

### æ£€ç´¢æ€§èƒ½
- **å‘é‡æ£€ç´¢**: < 50ms (10K å®ä½“)
- **ç›¸ä¼¼åº¦è®¡ç®—**: < 10ms
- **æ‰¹é‡ç¼–ç **: 100 æ–‡æœ¬/ç§’

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æœ¬åœ°æ¨¡å‹åŠ è½½å¤±è´¥
```bash
# æ£€æŸ¥æ¨¡å‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la ./models/multilingual-e5-base/

# æ£€æŸ¥æ¨¡å‹å®Œæ•´æ€§
python -c "
from sentence_transformers import SentenceTransformer
try:
    model = SentenceTransformer('./models/multilingual-e5-base')
    print('æ¨¡å‹åŠ è½½æˆåŠŸ')
except Exception as e:
    print(f'æ¨¡å‹åŠ è½½å¤±è´¥: {e}')
"
```

#### 2. å‘é‡ç»´åº¦ä¸åŒ¹é…
ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„ `VECTOR_DIMENSION=768` ä¸ multilingual-e5-base æ¨¡å‹çš„å®é™…ç»´åº¦åŒ¹é…ã€‚

#### 3. å†…å­˜ä¸è¶³
- å‡å°‘ `BATCH_SIZE` å’Œ `VECTOR_BATCH_SIZE`
- ä½¿ç”¨ GPU åŠ é€Ÿï¼ˆå¦‚æœå¯ç”¨ï¼‰
- å¢åŠ ç³»ç»Ÿå†…å­˜

#### 4. æ¨¡å‹ä¸‹è½½ç¼“æ…¢
è®¾ç½®å›½å†…é•œåƒï¼š
```bash
export HF_ENDPOINT=https://hf-mirror.com
```

### æ€§èƒ½ä¼˜åŒ–

#### 1. GPU åŠ é€Ÿ
åœ¨ `.env` æ–‡ä»¶ä¸­å¯ç”¨ GPUï¼š
```bash
ENABLE_GPU=true
```

#### 2. æ‰¹é‡å¤„ç†ä¼˜åŒ–
è°ƒæ•´æ‰¹é‡å¤§å°ï¼š
```bash
VECTOR_BATCH_SIZE=16  # å‡å°‘å†…å­˜ä½¿ç”¨
BATCH_SIZE=64         # å¢åŠ å¤„ç†é€Ÿåº¦
```

#### 3. ç¼“å­˜ä¼˜åŒ–
è®¾ç½®æ¨¡å‹ç¼“å­˜ï¼š
```bash
TRANSFORMERS_CACHE=./models/transformers_cache
SENTENCE_TRANSFORMERS_HOME=./models/sentence_transformers
```

## ğŸ†• æœ¬åœ°æ¨¡å‹ç‰ˆæœ¬æ›´æ–°

### v2.0.0 (å½“å‰ç‰ˆæœ¬)
- âœ… é›†æˆæœ¬åœ° multilingual-e5-base æ¨¡å‹
- âœ… ä¼˜åŒ–å‘é‡æœåŠ¡æ€§èƒ½
- âœ… æ”¯æŒç¦»çº¿è¿è¡Œ
- âœ… å¢å¼ºæ¨¡å‹ç®¡ç†åŠŸèƒ½
- âœ… æ”¹è¿›é”™è¯¯å¤„ç†å’Œæ—¥å¿—

### v1.0.0 (åŸç‰ˆæœ¬)
- åŸºç¡€æ ‡æ³¨åŠŸèƒ½
- åœ¨çº¿æ¨¡å‹ä¾èµ–
- çŸ¥è¯†å›¾è°±æ„å»º
- Web ç®¡ç†ç•Œé¢

## ğŸ”„ ä»åœ¨çº¿ç‰ˆæœ¬è¿ç§»

å¦‚æœæ‚¨ä»åœ¨çº¿æ¨¡å‹ç‰ˆæœ¬è¿ç§»åˆ°æœ¬åœ°æ¨¡å‹ç‰ˆæœ¬ï¼š

1. **å¤‡ä»½æ•°æ®**
```bash
# å¤‡ä»½ Neo4j æ•°æ®
docker exec neo4j neo4j-admin dump --database=neo4j --to=/backups/neo4j.dump

# å¤‡ä»½å‘é‡ç´¢å¼•
cp -r data/ data_backup/
```

2. **æ›´æ–°é…ç½®**
```bash
# æ›´æ–°ç¯å¢ƒå˜é‡
LOCAL_MODEL_PATH=./models/multilingual-e5-base
VECTOR_DIMENSION=768
```

3. **é‡å»ºå‘é‡ç´¢å¼•**
ç”±äºæ¨¡å‹å˜æ›´ï¼Œéœ€è¦é‡æ–°æ„å»ºå‘é‡ç´¢å¼•ï¼š
```bash
curl -X POST http://localhost:5000/api/vector/index/build \
  -H "Content-Type: application/json" \
  -d '{"texts": ["your", "texts", "here"]}'
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®ç»´æŠ¤è€…: [Your Name]
- é‚®ç®±: [your.email@example.com]
- é—®é¢˜åé¦ˆ: [GitHub Issues](https://github.com/your-repo/issues)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒ:
- [multilingual-e5-base](https://huggingface.co/intfloat/multilingual-e5-base) - å¤šè¯­è¨€åµŒå…¥æ¨¡å‹
- [Neo4j](https://neo4j.com/) - å›¾æ•°æ®åº“
- [FAISS](https://github.com/facebookresearch/faiss) - å‘é‡æ£€ç´¢
- [Sentence Transformers](https://www.sbert.net/) - è¯­ä¹‰åµŒå…¥
- [Flask](https://flask.palletsprojects.com/) - Web æ¡†æ¶

