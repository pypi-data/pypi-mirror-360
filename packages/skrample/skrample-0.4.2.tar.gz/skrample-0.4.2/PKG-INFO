Metadata-Version: 2.4
Name: skrample
Version: 0.4.2
Summary: Composable sampling functions for diffusion models
Author-email: Beinsezii <beinsezii@gmail.com>
License-Expression: Apache-2.0
License-File: LICENSE
Requires-Python: >=3.12
Requires-Dist: numpy>=2.0
Provides-Extra: all
Requires-Dist: scipy>=1.12; extra == 'all'
Requires-Dist: torch>=2.5; extra == 'all'
Requires-Dist: torchsde>=0.2.6; extra == 'all'
Provides-Extra: beta-schedule
Requires-Dist: scipy>=1.12; extra == 'beta-schedule'
Provides-Extra: brownian-noise
Requires-Dist: torchsde>=0.2.6; extra == 'brownian-noise'
Provides-Extra: cdf-schedule
Requires-Dist: scipy>=1.12; extra == 'cdf-schedule'
Provides-Extra: dev
Requires-Dist: accelerate>=1.3; extra == 'dev'
Requires-Dist: diffusers>=0.32; extra == 'dev'
Requires-Dist: matplotlib>=3.10.1; extra == 'dev'
Requires-Dist: protobuf>=5.29; extra == 'dev'
Requires-Dist: pyright>=1.1.400; extra == 'dev'
Requires-Dist: pytest-xdist>=3.6.1; extra == 'dev'
Requires-Dist: pytest>=8.3; extra == 'dev'
Requires-Dist: ruff>=0.12.1; extra == 'dev'
Requires-Dist: scipy>=1.12; extra == 'dev'
Requires-Dist: sentencepiece>=0.2; extra == 'dev'
Requires-Dist: torch>=2.5; extra == 'dev'
Requires-Dist: torchsde>=0.2.6; extra == 'dev'
Requires-Dist: transformers>=4.48; extra == 'dev'
Provides-Extra: diffusers-wrapper
Requires-Dist: torch>=2.5; extra == 'diffusers-wrapper'
Provides-Extra: pytorch
Requires-Dist: torch>=2.5; extra == 'pytorch'
Provides-Extra: scripts
Requires-Dist: matplotlib>=3.10.1; extra == 'scripts'
Requires-Dist: scipy>=1.12; extra == 'scripts'
Requires-Dist: torch>=2.5; extra == 'scripts'
Requires-Dist: torchsde>=0.2.6; extra == 'scripts'
Provides-Extra: test
Requires-Dist: accelerate>=1.3; extra == 'test'
Requires-Dist: diffusers>=0.32; extra == 'test'
Requires-Dist: matplotlib>=3.10.1; extra == 'test'
Requires-Dist: protobuf>=5.29; extra == 'test'
Requires-Dist: pyright>=1.1.400; extra == 'test'
Requires-Dist: pytest-xdist>=3.6.1; extra == 'test'
Requires-Dist: pytest>=8.3; extra == 'test'
Requires-Dist: ruff>=0.12.1; extra == 'test'
Requires-Dist: scipy>=1.12; extra == 'test'
Requires-Dist: sentencepiece>=0.2; extra == 'test'
Requires-Dist: torch>=2.5; extra == 'test'
Requires-Dist: torchsde>=0.2.6; extra == 'test'
Requires-Dist: transformers>=4.48; extra == 'test'
Description-Content-Type: text/markdown

# Skrample 0.4.2
Composable sampling functions for diffusion models

## Status
Mostly complete for common models, superseding all diffusers features in [quickdif](https://github.com/Beinsezii/quickdif.git)

### Quickstart
Fastest way to jump in is [examples](./examples/). The classes and functions themselves have docstrings and type hints, so it's recommended to make liberal use of your IDE or python `help()`

### Feature Flags
 - `beta-schedule` -> `scipy` : For the `Beta()` schedule modifier
 - `brownian-noise` -> `torchsde` : For the `Brownian()` noise generator
 - `cdf-schedule` -> `scipy` : For the `SigmoidCDF()` schedule
 - `diffusers-wrapper` -> `torch` : For the `diffusers` integration module
 - `pytorch` -> `torch` : For the `pytorch` module
   - `pytorch.noise` : Custom generators
 - `all` : All of the above
 - `dev` : For running `tests/`

### Samplers
- Euler
- DPM
  - 1st order, 2nd order, 3rd order
  - SDE
- Adams/IPNDM
- UniP & UniPC
  - N order, limited to 9 for stability
  - Custom solver via other SkrampleSampler types
- SPC
  - Basic fully customizable midpoint corrector

### Schedules
- Linear
- Scaled
  - `uniform` flag, AKA `"trailing"` in diffusers
- SigmaCDF
- ZSNR

### Schedule modifiers
- Karras
- Exponential
- FlowShift
- Beta
- Hyper

### Predictors
- Epsilon
- Velocity / vpred
- Flow

### Noise generators
- Random
- Brownian
- Offset
- Pyramid

## Integrations
### Diffusers
- [X] Compatibility for pipelines
  - [X] SD1
  - [X] SDXL
  - [X] SD3
  - [X] Flux
- [X] Import from config
  - [X] Sampler
  - [X] Schedule
  - [X] Predictor
- [X] Manage state
  - [X] Steps
  - [X] Higher order
  - [X] Generators
  - [X] Config as presented

## Implementations
### quickdif
My diffusers cli [quickdif](https://github.com/Beinsezii/quickdif) has full support for all major Skrample features, allowing extremely fine-grained customization.
