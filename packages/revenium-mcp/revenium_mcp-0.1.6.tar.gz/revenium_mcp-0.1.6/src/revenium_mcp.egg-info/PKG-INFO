Metadata-Version: 2.4
Name: revenium-mcp
Version: 0.1.6
Summary: Model Context Protocol (MCP) server for Revenium API monitoring, analytics, and AI spending management
Author-email: Jason Cumberland <jason@revenium.io>
Maintainer-email: Jason Cumberland <jason@revenium.io>
License-Expression: MIT
Project-URL: Homepage, https://github.com/revenium/revenium-mcp
Project-URL: Documentation, https://github.com/revenium/revenium-mcp#readme
Project-URL: Repository, https://github.com/revenium/revenium-mcp
Project-URL: Bug Tracker, https://github.com/revenium/revenium-mcp/issues
Keywords: mcp,revenium,api,ai,assistant,cli,server,model-context-protocol,anthropic,claude
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Internet :: WWW/HTTP :: HTTP Servers
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Classifier: Framework :: AsyncIO
Classifier: Environment :: Console
Classifier: Topic :: Utilities
Classifier: Typing :: Typed
Requires-Python: >=3.11
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: fastmcp>=0.1.0
Requires-Dist: httpx>=0.25.0
Requires-Dist: pydantic>=2.0.0
Requires-Dist: loguru>=0.7.0
Requires-Dist: python-dotenv>=1.0.0
Requires-Dist: openai>=1.0.0
Requires-Dist: revenium-middleware-openai>=0.4.6
Requires-Dist: matplotlib>=3.7.0
Requires-Dist: numpy>=1.24.0
Requires-Dist: aiofiles>=23.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.21.0; extra == "dev"
Requires-Dist: pytest-mock>=3.10.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: isort>=5.12.0; extra == "dev"
Requires-Dist: flake8>=6.0.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Requires-Dist: pre-commit>=3.0.0; extra == "dev"
Provides-Extra: test
Requires-Dist: pytest>=7.0.0; extra == "test"
Requires-Dist: pytest-cov>=4.0.0; extra == "test"
Requires-Dist: pytest-asyncio>=0.21.0; extra == "test"
Requires-Dist: pytest-mock>=3.10.0; extra == "test"
Requires-Dist: requests-mock>=1.10.0; extra == "test"
Dynamic: license-file

# Revenium MCP Server

**Connect AI agents to Revenium**

Connect Claude, OpenAI, or any MCP-compatible AI assistant to Revenium's API for AI cost alerts & tracking as well as usage-based billing for AI products. 

## AI Cost Tracking & Alerting - **Never Be Surprised by Unexpected AI Costs Again**
- Configure development agents to set up AI cost alerts for newly implemented AI-backed features to avoid unexpected costs
- Ask AI agents to track their own costs with Revenium as they carry out actions within your application
- Ask AI agents to develop AI cost & usage trends over time and set up alerts to immediately send slack or email notifications when anomalies occur
- Quickly investigate the reasons for AI cost spikes. Identify abnormal changes in spending by agent, API key, product, customer, and more.
- Help AI agents to integrate Revenium metering into your applications if not using Revenium's pre-built SDKs


## Usage-based Billing & Chargebacks
- Manage all elements of usage-based billing & cost chargebacks
- Manage products, customers, subscriptions, and subscriber credentials

[![Version](https://img.shields.io/badge/version-0.1.6-blue)](https://github.com/revenium/revenium-mcp)
[![License](https://img.shields.io/badge/license-MIT-green)](LICENSE)
[![MCP Compatible](https://img.shields.io/badge/MCP-Compatible-purple)](https://modelcontextprotocol.io)

---

## üõ†Ô∏è Available Tools

The MCP provides up to 15 tools depending on your chosen startup profile:

### **Setup & Onboarding**
Get started quickly with guided setup and configuration validation.
- Setup guidance to ensure the required environment variables are properly configured
- Configure email notifications for alert delivery
- *Example: "Show me my setup status and what needs to be configured"*
- *Example: "Help me set up email notifications for alerts"*
- *Example: "Check if my MCP server is properly configured"*
- *Example: "Guide me through the initial setup process"*

### üö® **Alert Management**
Set up intelligent monitoring for costs, usage, and performance metrics.
- Create budget threshold and spike detection alerts 
- Get notified via Slack or email when patterns change
- *Example: "Alert me when monthly costs for Anthropic exceed $500"*
- *Example: "Create a spike detection alert when token use exceeds 1,500,000 tokens per hour"*
- *Example: "Alert when error rate exceeds 5% every 5 minutes"*
- *Example: "Set up cost per transaction monitoring so any single AI call costing more than $1.50 triggers an immediate Slack alert"*
- 
### üì± **Slack Integration**
- *Example: "Set up Slack notifications for Revenium alerts"*
- *Example: "Add a new slack channel for all customer spending alerts"*
- *Example: "Send all product spending anaomalies to the Slack channel #product-spend-alerts."*

### üìà **AI Business Analytics**
Analyze costs, usage patterns, and performance.
- Cost trend analysis and breakdowns
- *Example: "Summarize my costs for the last day/week/month and highlight any anomalies"*
- *Example: "Explain why costs grew last week"*
- *Example: "Show me a breakdown of AI costs last month by provider/customer/product/agent"*

#### Common Use Cases

**"Why did my costs spike yesterday?"**
- *"Analyze cost anomalies in the last 7 days focusing on abnormal spending by model or API key"*
- *"Detect what caused my cost increase yesterday. Only focus on anomalies larger than $20 vs. the norm"*

**"Find anomalies across all dimensions"**  
- *"Show me cost anomalies in the last month across all providers, models, agents, API keys, and customers"*
- *"Analyze all dimensions for cost spikes above $150 in the past 30 days"*

**"Detect small but significant anomalies to identify early changes in behavior before they become large issues"**
- *"Find API key anomalies in the last week using aggressive sensitivity"*


### üìà **Metering Management**
Track AI usage, token consumption, and transaction data with comprehensive integration guidance.
- Get assistance creating a new custom integration from your AI agents to Revenium
- Get comprehensive implementation guidance with working code examples for Python and JavaScript
- Submit AI transaction data and verify successful processing

- *Example: "Get Python integration guide with working code examples for AI transaction metering"*
- *Example: "Get JavaScript integration guide with official npm package references"*
- *Example: "Check the status of transaction tx_12345"*
- *Example: "Help me integrate this python AI function with Revenium's AI metering API"*
- *Example: "Generate test transaction data from our application and ensure all metadata is properly mapped in Revenium."*

### üìä **Product Management**
Create and manage your AI products, pricing tiers, and billing models.
- Design usage-based or subscription pricing
- Design chargeback models so that all AI spending is invoiced to the correct internal department
- Set up free tiers and graduated pricing for SaaS products
- *Example: "Create a Gold Tier AI product with $199 per month base fee plus usage-based pricing that charges 1.10x the actual AI costs"*
- *Example: "Create a new product called 'Smart Analytics' with usage-based pricing"*
- *Example: "Set up a free tier with 1000 API calls, then charge a 25% premium on my AI costs for every call"*
- *Example: "Show me the number of subscribers for each of my products"*

### üë• **Customer Management**
Handle customer relationships, organizations, and user hierarchies.
- Manage customer or internal organizations used for cost attribution
- Create & manage subscribers (internal or external)
- Track customer usage

- *Example: "List all organizationss and their subscription status"*

### üìã **Subscription Management**
Control customer subscriptions, billing cycles, and plan changes.
- Create and modify customer subscriptions
- Track subscription analytics
- *Example: "Create a monthly subscription for customer ABC Corp to the product 'analytics-suite'"*
- *Example: "Show me all active subscriptions to the AI Analytics product"*
- *Example: "List subscriptions that are about to expire this month"*

### **Known Limitations**
Revenium's API provides many other endpoints that are not yet been implemented.  If there is one you'd like to see added, submit a PR or open an issue with the request.

---

## üöÄ Quick Start

### Step 1: Choose Your Profile

The MCP server supports **two profiles** to match your use case:

#### **Profile Overview**

| Profile | Tools | Target Users | Use Cases |
|---------|-------|--------------|-----------|
| **Starter** | 7 tools | Cost monitoring & alerts | Cost analysis, AI transaction metering |
| **Business** | 15 tools | Product & subscription management, usage-based billing, comprehensive analytics |

#### **Startup Commands**

Choose your profile by setting the `TOOL_PROFILE` environment variable:

```bash
# Starter Profile (7 tools) - Cost monitoring, alerts, AI metering integration
TOOL_PROFILE=starter python run_server_dev.py

# Business Profile (15 tools) - Usage-based billing & AI Analytics (default)
TOOL_PROFILE=business python run_server_dev.py
# or simply:
python run_server_dev.py
```

### Step 2: Configure Your AI Assistant

Configure the MCP server in your AI assistant client. Only your API key is required - other configuration values are loaded automatically.

Follow the configuration instructions below for your specific AI assistant client:

---

## üíª Installation

### Prerequisites

- **Python 3.11+** with pip
- **Your Revenium API key**
- **Optional**: [uv/uvx](https://github.com/astral-sh/uv)

### For Claude Code

**Option 1: Isolated Installation with uvx (Recommended)**
```bash
# Install uv if you don't have it  
pip install uv

# One-shot installation - uvx manages isolation automatically
claude mcp add revenium \
  -e REVENIUM_API_KEY=your_api_key_here \
  -- uvx run revenium-mcp
```

**Option 2: Virtual Environment Installation**
```bash
# Create and activate virtual environment
python -m venv revenium-mcp-env
source revenium-mcp-env/bin/activate  # On Windows: revenium-mcp-env\Scripts\activate

# Install package
pip install revenium-mcp

# Add to Claude Code using venv python
claude mcp add revenium \
  -e REVENIUM_API_KEY=your_api_key_here \
  -- ./revenium-mcp-env/bin/python -m revenium_mcp_server
```

**Advanced Installation with Custom Settings (any installation method)**
```bash
claude mcp add revenium \
  -e REVENIUM_API_KEY=your_api_key_here \
  -e REVENIUM_TEAM_ID=ABC123x \
  -e REVENIUM_TENANT_ID=DEF456n \
  -e REVENIUM_OWNER_ID=GHI789z \
  -e REVENIUM_BASE_URL=https://api.revenium.io \
  -e REVENIUM_APP_BASE_URL=https://ai.revenium.io \
  -e REVENIUM_DEFAULT_EMAIL=your_email@company.com \
  -- uvx run revenium-mcp
  # OR: -- ./revenium-mcp-env/bin/python -m revenium_mcp_server
```

**Restart & Verify Install:**
- Run `claude mcp list` to verify the server is installed
- Run `claude mcp get revenium` to see configuration details  
- Start Claude Code and use `/mcp` to check server status

### For Claude Desktop

Follow the same uvx / pip installation instructions listed for Claude Code.

**Locate your Claude Desktop config file:**
- **macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
- **Windows**: `%APPDATA%\Claude\claude_desktop_config.json`

**Add this configuration:**

**Standard Configuration:**
```json
{
  "mcpServers": {
    "revenium": {
      "command": "python",
      "args": ["-m", "revenium_mcp_server"],
      "env": {
        "REVENIUM_API_KEY": "your_api_key_here"
      }
    }
  }
}
```

**Restart Claude Desktop**

### For VS Code with Copilot Chat

**Install the package first:**
```bash
pip install revenium-mcp
```

**Configure MCP server:**

1. Open VS Code settings (Ctrl/Cmd + ,)
2. Search for "mcp" and enable `chat.mcp.enabled`
3. Create or edit `.vscode/mcp.json` in your workspace:

**Standard Configuration:**
```json
{
  "mcpServers": {
    "revenium": {
      "command": "python",
      "args": ["-m", "revenium_mcp_server"],
      "env": {
        "REVENIUM_API_KEY": "your_api_key_here"
      }
    }
  }
}
```

### For Cursor IDE

**Install the package first:**
```bash
pip install revenium-mcp
```

**Configure MCP server:**

1. Open Cursor settings (Ctrl/Cmd + ,)
2. Navigate to Extensions ‚Üí MCP or create `~/.cursor/mcp.json`
3. Add server configuration:

**Standard Configuration:**
```json
{
  "mcpServers": {
    "revenium": {
      "command": "python",
      "args": ["-m", "revenium_mcp_server"],
      "env": {
        "REVENIUM_API_KEY": "your_api_key_here"
      }
    }
  }
}
```

### Step 3: Configuration Complete

The MCP server will load additional configuration values from your account automatically, including Team ID, Tenant ID, Owner ID, and default email.

### Optional Configuration Overrides

You can override the automatically loaded values if needed:

**When you might need overrides:**
- Multi-tenant environments: Switching organizations in a multi-tenant Revenium installation 
- Custom email preferences: Change default email address for alert configuration
- Custom API endpoints: When not using Revenium's default API endpoints

---

## üîß Configuration Details

### MCP Client Configuration

Configure environment variables directly in your MCP client's JSON configuration.

### Required Configuration

| Variable | Required | Description | Example |
|----------|----------|-------------|---------|
| `REVENIUM_API_KEY` | ‚úÖ | Your account API key from the API Keys page in Revenium | `hak_1234567890abcdef` |

### Automatically Loaded Values

These values are loaded from your account and can be overridden if needed:

| Variable | Override When | Example |
|----------|---------------|---------|
| `REVENIUM_TEAM_ID` | Multi-tenant environments | `ABC123x` |
| `REVENIUM_TENANT_ID` | Operating on behalf of different tenant | `DEF456n` |
| `REVENIUM_OWNER_ID` | Non-primary user scenarios | `GHI789z` |
| `REVENIUM_DEFAULT_EMAIL` | Custom alert email preferences | `alerts@company.com` |

### Optional Configuration

| Variable | Required | Description | Example |
|----------|----------|-------------|---------|
| `REVENIUM_BASE_URL` | ‚ö™ | API endpoint URL (defaults to main Revenium instance) | `https://api.revenium.io/meter` |
| `REVENIUM_APP_BASE_URL` | ‚ö™ | Defines which Revenium web application instance to use for Slack channel configurations (defaults to main Revenium instance) | `https://ai.revenium.io` |
| `LOG_LEVEL` | ‚ö™ | Logging verbosity level | `DEBUG` |
| `REQUEST_TIMEOUT` | ‚ö™ | API request timeout in seconds | `30` |


---

## üîç Troubleshooting

#### Authentication Errors
- Verify your API key is correct and active
- Use the diagnostic tool to check configuration status
- Ensure the base URL is correct for your environment
- Check that the `/users/me` endpoint is accessible with your API key

#### Configuration Priority
The system loads configuration values in this priority order:
1. **MCP client JSON configuration `env` section** (highest priority)
2. **System environment variables**
3. **Automatically loaded values** from Revenium's API

Use the `system_diagnostics` tool to see exactly which values are being used from each source.

### Getting Help

- **Issues**: Report problems on [GitHub Issues](https://github.com/revenium/revenium-mcp/issues)
- **Support**: Email [support@revenium.io](mailto:support@revenium.io)

---

## üìÑ License & Support

**License**: MIT License - see [LICENSE](LICENSE) file for details.

**Support Channels**:
- üìß **Email**: [support@revenium.io](mailto:support@revenium.io)
- üêõ **Issues**: [GitHub Issues](https://github.com/revenium/revenium-mcp/issues)

---
