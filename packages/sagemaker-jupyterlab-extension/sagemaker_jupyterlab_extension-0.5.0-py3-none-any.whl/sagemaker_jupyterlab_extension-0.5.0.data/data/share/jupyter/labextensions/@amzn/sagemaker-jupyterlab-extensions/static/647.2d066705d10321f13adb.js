"use strict";(self.webpackChunk_amzn_sagemaker_jupyterlab_extensions=self.webpackChunk_amzn_sagemaker_jupyterlab_extensions||[]).push([[647],{53647:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ut});var a=n(80211);const s="@amzn/sagemaker-jupyterlab-extensions:gitclone",i="@amzn/sagemaker-jupyterlab-extensions:performance-metering",o="@amzn/sagemaker-jupyterlab-extension-common:projects-clonerepository",r="@amzn/sagemaker-jupyterlab-extensions:spacemenu",l="@amzn/sagemaker-jupyterlab-extensions:libmanagement",c={shutdown:"filemenu:shutdown"},d="Sso",p=3e5,u=500,g=100,m=12e4,h={SignInSession:{closeButton:"Close",signInButton:"Sign In",saveButton:"Save",saveAndRenewButton:"Save and renew session",signinDialog:{title:"Please sign in again",restartSessionBody:"You were logged out of your account. You are not able to perform actions in your workplace at this time. Please start a new session.",loggedOutBody:"You were logged out of your account. Choose 'Sign In' to continue using this workplace."},sessionExpiredDialog:{title:"Session Expired please signin"},renewSessionDialog:{title:"Session expiring soon",defaultBodyText:"If your session expires, you could lose unsaved changes.",renewSessionBody:'To renew the session, log out from Studio App via "File" -> "Log Out" and then "Sign out" from AWS IAM Identity Center (successor to AWS SSO) user portal.',saveAllChanges:"Do you want to save all changes now?",renewSessionNow:"Do you want to renew your session now?",remindText:"Remind me in 5 minutes",soonExpiringSessionBody:"This session will expire soon.",contDownTimerMessage:"This session will expire ",fromNow:"from now.",loseUnsavedChanges:"If your session expires, you could lose unsaved changes."}},ResourceUsage:{cpuMetricTitle:"CPU:",memoryMetricTitle:"MEM:",storageMetricTitle:"Storage:",instanceMemoryProgressBarTitle:"Instance MEM",instanceMetricsTitle:"Instance",stoargeSpaceLimitDialog:{title:"Free up storage space"}},GitClone:{dialogTitle:"Clone Git Repository",repoTitle:"Git repositories URL(.git):",pathTitle:"Project directory to clone into:",afterCloningTitle:"After cloning",openReadMeFilesLabel:"Open README files.",cancelButton:"Cancel",cloneButton:"Clone",errors:{directoryNotExistTitle:"Destination directory doesn’t exist.",directoryNotExistBody:"The destination directory doesn’t exist. Create this directory and then try cloning the repository again. directory: ",localGitCloneExistTitle:"Repository clone already exists in project.",localGitCloneExistBody:"It looks like the Git repository has already been cloned into the given directory. Click Dismiss to navigate to your existing clone. repositoy: ",noURLErrorTitle:"Missing valid URL.",noURLErrorBody:'No URL listed to clone the repository. Please input a valid URL ending with ".git".',generalCloneErrorTitle:"Unable to clone repository to project.",generalCloneErrorBody:"Something went wrong when trying to clone the repository to your project. Please try again later. ",failedOptions:"Failed to handle additional options.",failedOptionsBody:"Something went wrong when trying to open README file within the repo.",invalidCloneUrlTitle:"Invalid URL provided",invalidCloneUrlBody:"The URL provided is not valid. Please input a valid URL to clone."}},Space:{privateSpaceHeader:"Personal Studio",unknownUser:"Unknown User",unknownSpace:"Unknown Space"},ProjectsCloneRepo:{errorDialog:{errorTitle:"Unable to clone repository",defaultErrorMessage:"Something went wrong when cloning the repository.",invalidRequestErrorMessage:"A request to clone the reposioty is invalid.",invalidProjectName:"Invalid project name: Project does not exist.",invalidCloneUrlBody:"The URL provided is not valid. Please input a valid URL to clone."}}},y="GitCloneDialogError",v="ValidRepoPathError",f="spaceMenuHeader",w={id:"@amzn/sagemaker-jupyterlab-extensions:hideshutdown",requires:[a.IMainMenu],autoStart:!0,activate:(e,t)=>{e.commands._commands.get(c.shutdown).isVisible=()=>!1}};var E=n(29801),C=n.n(E),S=n(66029),b=n.n(S),x=n(71342),k=n(35238);class M{constructor(){this._dismissTime=0,this._count=0}setDismissTime(e){e&&(this._dismissTime=e,this._count=1)}getDismissTime(){return this._dismissTime}}const j=()=>{const e=_("authMode");return e&&e[1]&&e[1]===d},_=e=>document.cookie.match("\\b"+e+'="?([^;]*)"?\\b'),L=()=>{const e=_("expiryTime"),t=_("ssoExpiryTimestamp");return j()&&t?Number(t[1]):e?Number(e[1]):null},T=(e,t)=>{var n,a;t?null===(n=e.serviceManager)||void 0===n||n.connectionFailure.disconnect(x.ConnectionLost):null===(a=e.serviceManager)||void 0===a||a.connectionFailure.connect(x.ConnectionLost)},R=()=>{const e=_("redirectURL");let t;try{if(t=new URL(e?e[1]:void 0),"http:"===t.protocol||"https:"===t.protocol)return t.toString()}catch(e){return}},N=(e,t)=>{const n=L(),a=window.open(e,"signin window","width=800, height=600");let s=!1;const i=window.setInterval((()=>{if(a&&a.closed&&!s)return void window.clearInterval(i);const e=L();if(null!==e&&null!==n&&(e>n||isNaN(e))){window.clearInterval(i),a&&a.close(),s=!0;for(const e of t)e.kernel.reconnect();k.Dialog.tracker.forEach((e=>e.reject()))}}),g)},D=async()=>{const{SignInSession:e}=h,{signinDialog:t}=e,n=R(),a=n?[k.Dialog.okButton({label:e.signInButton})]:[k.Dialog.cancelButton({label:e.closeButton})],s=n?b().createElement("div",{"data-testid":"session-signin-log-out"},t.loggedOutBody):b().createElement("div",{"data-testid":"session-signin-restart"},t.restartSessionBody),i=new k.Dialog({title:t.title,body:s,buttons:a,hasClose:!1});return{sigInDialogResult:await i.launch(),confirmDialog:i}};var P=n(76797),I=n(96697),U=n(26027),A=n(23776),B=n(70346);const O=(e,t,n,a,s,i,o)=>{const r=L(),l=o(),c=l&&l+p;if(null===r)T(e,!1);else{const o=C().unix(r/1e3).diff(C()()),d=Date.now();((e,t,n)=>((e,t)=>-1===e&&t)(t,e)||((e,t)=>e<=0&&!t)(n,e))(j(),r,o)?(a(),(async(e,t,n)=>{const{SignInSession:a}=h,s=R();k.Dialog.tracker.forEach((e=>e.reject())),T(e,!0);const{sigInDialogResult:i,confirmDialog:o}=await D();if(i&&i.button)if(n(),s)N(R(),t);else if(i&&i.button.label===a.closeButton){const e=L(),t=e&&e/1e3,n=t&&C().unix(t).diff(C()());null!==n&&n&&n>p&&(o.dispose(),setTimeout((async()=>{await D()}),p))}else o.dispose(),N(R(),t)})(e,t,s)):o<=9e5&&(void 0===l||c&&d>c)?(a(),(async(e,t,n,a,s)=>{const{SignInSession:i}=h,{renewSessionDialog:o}=h.SignInSession,{renewSessionDialogResult:r,confirmDialog:l}=await(async()=>{const{SignInSession:e}=h,{renewSessionDialog:t}=h.SignInSession,n=R(),a=L(),s=a&&C().unix(a/1e3).fromNow(),i=`${t.contDownTimerMessage}${s}.`,o=`${j()?t.soonExpiringSessionBody:i}`,r=t.renewSessionBody,l=j()?b().createElement(b().Fragment,null,b().createElement("div",{"data-testid":"session-renew-lose-unsaved-changes"},o," ",t.loseUnsavedChanges," ",t.saveAllChanges),b().createElement("div",null,r)):b().createElement("div",{"data-testid":"session-renew-now"},b().createElement("p",null,o),b().createElement("p",null,t.renewSessionNow)),c=[k.Dialog.okButton({label:t.remindText}),n&&k.Dialog.okButton({label:e.saveAndRenewButton})],d=new k.Dialog({title:t.title,body:l,buttons:c,hasClose:!1});return{renewSessionDialogResult:await d.launch(),confirmDialog:d}})();if(r&&r.button.label===o.remindText){const e=new M;0===e._count?(e.setDismissTime(Date.now()),s(e._dismissTime)):e.getDismissTime(),l.dispose(),a()}else r&&r.button.label===i.saveAndRenewButton&&(l.dispose(),n(),a(),j()||N(R(),t))})(0,t._sessions,n,s,i),T(e,!1)):T(e,!1)}},F={id:"@amzn/sagemaker-jupyterlab-extensions:sessionmanagement",requires:[],autoStart:!0,activate:async e=>{let t;const n=e.serviceManager.sessions,a=()=>{s.start()},s=((e,t,n,a,s,i,o)=>new P.Poll({auto:!0,factory:async()=>O(e,t,n,a,s,i,o),frequency:{interval:u,backoff:!0,max:m}}))(e,n,(()=>{const t=new U.TextModelFactory,n=new U.DocumentRegistry({textModelFactory:t}),a=new A.ServiceManager({}),s=new B.DocumentManager({registry:n,manager:a,opener:{open:e=>{},get opened(){return{connect:()=>!1,disconnect:()=>!1}}}});(0,I.each)(e.shell.widgets("main"),(e=>{const t=s.contextForWidget(e);void 0!==t&&t.save().then((()=>t.createCheckpoint())).catch((e=>{if("Cancel"!==e.message)throw e}))}))}),(()=>{s.stop()}),a,(e=>{t=e}),(()=>t));a()}};var $=n(52446);const z=[200,201];var G,Z=n(40082);!function(e){e.POST="POST",e.GET="GET"}(G||(G={}));const V=async(e,t)=>{const n=A.ServerConnection.makeSettings(),a=Z.URLExt.join(n.baseUrl,e);try{const e=await A.ServerConnection.makeRequest(a,{method:t},n);if(!z.includes(e.status))throw new Error("Unable to fetch data");return e}catch(e){throw Error(e)}};var W=n(95933);const H="8px",J="12px",q=W.css`
  border-bottom: solid 1px var(--sm-border-color2);
`,Y=W.css`
  background-color: var(--jp-layout-color2);
  border: solid 1px var(--jp-border-color2);
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  position: fixed;
  bottom: 25px;
`,Q=W.css`
  margin: 0 ${J} ${H};
`,X=W.css`
  font-weight: bold;
  margin: ${H} 0 0 ${H};
`,K=(W.css`
  margin: 0 ${J} 0 ${"16px"};
`,W.css`
  border-radius: 10px;
  height: 100%;
  width: 30px;
`),ee=W.css`
  line-height: 24px;
  padding: 0 5px;

  &:hover {
    background-color: var(--jp-layout-color2);
  }
`,te=(W.css`
  padding-left: 4px;
`,W.css`
  display: flex;
  justify-content: flex-start;
  align-items: center;
  margin: 6px 12px;
`),ne=W.css`
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  padding-right: 5px;
`,ae=W.css`
  border-radius: 10px;
  width: 40px;
  margin: 0 0 2px 4px;
  height: 6px !important;
`,se=(W.css`
  border-radius: 10px;
  display: inline-block;
  width: 40px;
  height: 8px;
`,W.css`
  display: flex;
  align-items: center;
`);var ie=n(3221);const oe=({value:e,singleProgressBarStyle:t,displayValue:n,label:a,labelClassName:s,conatinerClassName:i})=>b().createElement("div",{role:"container","data-testid":"linear-progress-bar-container"},b().createElement("div",{className:i},a&&b().createElement("span",{className:s},a," ",n,"%"),b().createElement(ie.Z,{"data-testid":"linear-progress-bar",className:t,variant:"determinate",value:e}))),re="jlStudio-",le=`${re}ResourceUsageWidgetContainer`,ce=`${re}MetricsWidgetContainer`,de=({onClickHandler:e,instanceMetricsResponse:t,instanceMetricsDisplayValue:n})=>{const[a,s]=(0,S.useState)(!1),[i,o]=(0,S.useState)(0),[r,l]=(0,S.useState)(0),[c,d]=(0,S.useState)(0),[p,u]=(0,S.useState)(!1),g=e=>e&&void 0!==e?Math.round(e):0,m=e=>0===e?"0.0":e&&void 0!==e?e.toFixed(2).toString():"--";(0,S.useEffect)((()=>{if(void 0!==t&&(null==t?void 0:t.metrics)){const{metrics:e}=t,n=e.cpu.cpu_percentage,a=e.memory.memory_percentage,s=e.storage.used_space_in_bytes,i=e.storage.total_space_in_bytes,r=s&&i&&s/i*100;o(n),l(a),d(r)}}),[t]),(0,S.useEffect)((()=>{if(c&&c>95&&!1===p){const{stoargeSpaceLimitDialog:e}=h.ResourceUsage;k.Notification.info(e.title),u(!0)}}),[p,c]);const{instanceMemoryProgressBarTitle:y,instanceMetricsTitle:v,cpuMetricTitle:f,memoryMetricTitle:w,storageMetricTitle:E}=h.ResourceUsage;return b().createElement("div",{"data-testid":"resource-usage-widget","data-analytics-type":"eventContext","data-analytics":"JupyterLab",className:`${le} ${ee}`},b().createElement("div",{className:se,onClick:()=>(t=>{s(!t),e()})(a),"data-testid":"resource-usage-widget-click-handler","data-analytics-type":"eventDetail","data-analytics":"ResourceUsage-Widget-Click"},y," ",void 0===n?b().createElement(ie.Z,{"data-testid":"resource-usage-linear-progress-spinner",className:ae}):b().createElement("div",{className:se,"data-testid":"resource-usage-status-bar-container"},b().createElement(ie.Z,{className:ae,variant:"determinate",value:0|n}),n?Math.round(n):0,"%")),a&&b().createElement("div",{className:`${ce} ${Y}`,"data-testid":"resource-usage-data-container"},b().createElement("div",{className:q},b().createElement("div",{className:X},v),b().createElement("div",{className:Q},b().createElement("div",null,b().createElement(oe,{value:g(i),displayValue:m(i),label:f,labelClassName:ne,singleProgressBarStyle:K,conatinerClassName:te,"data-testid":"resource-usage-data-container-cpu"}),b().createElement(oe,{value:g(r),displayValue:m(r),label:w,labelClassName:ne,singleProgressBarStyle:K,conatinerClassName:te,"data-testid":"resource-usage-data-container-memory"}),b().createElement(oe,{value:g(c),displayValue:m(c),label:E,labelClassName:ne,singleProgressBarStyle:K,conatinerClassName:te,"data-testid":"resource-usage-data-container-storage"}))))))};class pe extends k.ReactWidget{constructor(){super(),this.clickHandler=()=>{this.update()},this.getInstanceMetrics=async()=>{await V("aws/sagemaker/api/instance/metrics",G.GET).then((e=>{e&&e.json().then((e=>{var t,n;this._instanceMetricsResponse=e||null,(null===(t=this._instanceMetricsResponse)||void 0===t?void 0:t.metrics.memory)?this._instanceMetricsDisplayValue=null===(n=this._instanceMetricsResponse)||void 0===n?void 0:n.metrics.memory.memory_percentage:this._instanceMetricsDisplayValue=void 0}))})),this.update()},this._getInstanceMetricsLoop=setInterval(this.getInstanceMetrics,5e3),this._instanceMetricsResponse=null,this._instanceMetricsDisplayValue=void 0}getInstanceMetricsResponse(){return this._instanceMetricsResponse}render(){return b().createElement(de,{onClickHandler:this.clickHandler,instanceMetricsResponse:this._instanceMetricsResponse,instanceMetricsDisplayValue:this._instanceMetricsDisplayValue})}}const ue={id:"@amzn/sagemaker-jupyterlab-extensions:resourceusage",requires:[$.IStatusBar],autoStart:!0,activate:async(e,t)=>{const n=new pe;t.registerStatusItem("@amzn/sagemaker-jupyterlab-extensions:resourceusage:resource-usage-widget",{item:n,align:"left",isActive:()=>!0,rank:100})}};var ge=n(39746),me=n(81031);const he=W.css`
  .MuiInputBase-input MuiInput-input {
    width: 400px;
    margin-bottom: 20px;
  }
`,ye=({label:e,id:t,helperText:n,error:a,handleChange:s,regEx:i,...o})=>{const[r,l]=(0,S.useState)(""),[c,d]=(0,S.useState)(!0);return b().createElement(me.Z,{variant:"standard",className:he,"data-testid":"text-field-container",error:!c,id:t,label:e,helperText:n,value:r,onChange:e=>(e=>{l(e.target.value);const t=new RegExp(i);d(t.test(e.target.value)),s(e.target.value)})(e),...o})},ve=W.css`
  &.jp-ThemedContainer {
    z-index: 2;
  }
`,fe=W.css`
  width: 460px;
  input {
    width: 460px;
  }
  .MuiFormControl-root.MuiTextField-root {
    margin-bottom: 20px;
  }
`;W.css`
  margin-bottom: 20px;
`;var we=n(14459);const Ee=(e=!1)=>W.css`
  color: var(--jp-color-root-light-800);
  font-weight: 400;
  font-size: var(--jp-ui-font-size1);
  line-height: var(--jp-ui-font-size1);
  margin-bottom: var(--jp-ui-font-size1);
  ${e&&"\n    &:after {\n      content: '*';\n      color: var(--jp-error-color1);\n    }\n  "}
`,Ce=W.css`
  margin-top: 20px;
`,Se=({options:e,handleChange:t,label:n,freeSolo:a})=>{const s=(e,n)=>{t(n)};return S.createElement("div",{className:Ce},S.createElement("label",{className:Ee(!0)},n),S.createElement(we.Z,{id:"autocomplete",freeSolo:a,autoSelect:!0,onChange:(e,t)=>s(0,t),onInputChange:(e,t)=>s(0,t),options:e.map((e=>e.label)),renderInput:e=>S.createElement(me.Z,{...e,variant:"outlined",size:"small",margin:"dense"})}))};var be=n(3283),xe=n(98920);const ke=({label:e,id:t,handleChange:n,...a})=>{const[s,i]=(0,S.useState)(!0);return b().createElement(b().Fragment,null,b().createElement(xe.Z,{control:b().createElement(be.Z,{"data-testid":"checkbox-field",inputProps:{"aria-label":"controlled"},checked:s,onChange:e=>{i(e.target.checked),n(e.target.checked)},id:t,...a}),label:e}))},Me=({gitRepositories:e,setGitURL:t,setPath:n,setOpenREADME:a})=>{const[s,i]=(0,S.useState)(""),[o,r]=(0,S.useState)(""),[l,c]=(0,S.useState)(!0),[d,p]=(0,S.useState)([]),{repoTitle:u,pathTitle:g,openReadMeFilesLabel:m}=h.GitClone;return(0,S.useEffect)((()=>{if(e&&e.GitCodeRepositories.length>=0){const t=[];e.GitCodeRepositories.length>0&&e.GitCodeRepositories.forEach((e=>t.push({value:e,label:e}))),p(t)}}),[e]),b().createElement("div",{className:fe,"data-testid":"git-clone-container","data-analytics-type":"eventContext","data-analytics":"JupyterLab"},b().createElement(Se,{"data-testid":"autocomplete-field-container","data-analytics-type":"eventDetail","data-analytics":"GitClone-Repo-AutoComplete",label:u,options:d,value:o,handleChange:e=>{r(e),t(e)},freeSolo:!0}),b().createElement(ye,{"data-testid":"text-field-container","data-analytics-type":"eventDetail","data-analytics":"GitClone-Path-TextField",error:!1,id:"path",label:g,helperText:"",valuePassed:s,handleChange:e=>{i(e),n(e)},regEx:"^([A-Za-z]*|[0-9]*|[/]*|[.]*|[A-Za-z0-9/.]*)$"}),b().createElement(ke,{"data-testid":"read-me-field","data-analytics-type":"eventDetail","data-analytics":"GitClone-OpenReadMeCheckbox",label:m,id:"openReadMe",handleChange:e=>{c(e),a(e)},checked:l}))};class je extends k.ReactWidget{constructor(){super(),this.setGitURL=e=>{this.URL=e},this.setPath=e=>{this.path=e},this.setOpenREADME=e=>{this.openREADME=e},this.getGitRepositories=async()=>{await V("aws/sagemaker/api/git/list-repositories",G.GET).then((e=>{e&&e.json().then((e=>{this._gitCloneRepositories=e||null,this.update()}))}))},this.URL="",this.path="",this.openREADME=!0,this._gitCloneRepositories=null,this.getGitRepositories()}getValue(){return{URL:this.URL,path:this.path,openREADME:this.openREADME}}render(){return b().createElement(Me,{gitRepositories:this._gitCloneRepositories,setGitURL:this.setGitURL,setPath:this.setPath,setOpenREADME:this.setOpenREADME})}}var _e=n(92916),Le=n(44593);const{name:Te,version:Re}=n(4147),Ne=(e,t,n)=>e.child({ExtensionName:Te,ExtensionVersion:Re,PluginId:t},n);var De;!function(e){e[e.CanClone=0]="CanClone",e[e.NotExist=1]="NotExist",e[e.AlreadyCloned=2]="AlreadyCloned"}(De||(De={}));const Pe=[{name:"README.ipynb",factory:"Notebook"},{name:"README.md",factory:"Markdown Preview"}],Ie=async(e,t,n)=>{const{repoPath:a,openREADME:s}=n;if(await e.execute("filebrowser:go-to-path",{path:a}),!0===s)try{await(async(e,t,n)=>{const a=await t.get(e);if("directory"===a.type){const t=Pe.find((e=>a.content.some((t=>t.name===e.name))));t&&await n.execute("docmanager:open",{path:Z.PathExt.join(e,t.name),factory:t.factory})}})(a,t,e)}catch(e){}},Ue=async(e,t)=>{let n;try{n=await t.get(e)}catch(e){return!1}return"directory"===n.type};var Ae=n(71775),Be=n(16017),Oe=n(24337),Fe=n(79510);const{dialogTitle:$e,cancelButton:ze,cloneButton:Ge,errors:Ze}=h.GitClone,Ve={id:s,requires:[ge.IFileBrowserFactory,ge.IDefaultFileBrowser,Le.IGitExtension,k.IToolbarWidgetRegistry,Be.ILogger,_e.ITranslator],autoStart:!0,activate:async(e,t,n,a,i,o,r)=>{const{commands:l,serviceManager:c}=e,d=c.contents,p=Ne(o,s),u=(r=r||_e.nullTranslator).load("sagemaker_studio");l.addCommand(Oe.TQ.gitClone,{label:"Git Clone Repo",caption:"",execute:()=>(async(e,t,n,a,s)=>{var i,o;const r=t.model;let l="";const c=null===(o=null===(i=null==e?void 0:e.tracker)||void 0===i?void 0:i.currentWidget)||void 0===o?void 0:o.model.path;let d,p=null!=c?c:"",u=!0,g=!0;const m=new k.Dialog({title:$e,body:new je,focusNodeSelector:"input",buttons:[k.Dialog.cancelButton({label:ze}),k.Dialog.okButton({label:Ge})],hasClose:!1});m.addClass(ve);try{d=await m.launch()}catch(e){return void s.error({Message:y,Error:e})}if(!d.button.accept||!d.value)return;var f;if(({URL:l,path:p,openREADME:u,findEnvironment:g}=d.value),"string"==typeof(f=p)&&f.length>0||(p="./"),!(e=>/^(https:\/\/|git)([:/@.~\-_a-zA-Z0-9])+$/.test(e))(l))return void await(0,k.showErrorMessage)(Ze.invalidCloneUrlTitle,{message:Ze.invalidCloneUrlBody});const w=(e=>{const t=Z.URLExt.parse(e);return Z.PathExt.basename(t.pathname,".git")})(l),E=Z.PathExt.join(p,w);let C;try{C=await(async(e,t,n,a)=>{const{errors:s}=h.GitClone;return await Ue(t,e)?await Ue(a,e)?(await(0,k.showErrorMessage)(s.localGitCloneExistTitle,{message:s.localGitCloneExistBody+n}),De.AlreadyCloned):De.CanClone:(await(0,k.showErrorMessage)(s.directoryNotExistTitle,{message:s.directoryNotExistBody+t}),De.NotExist)})(n,p,l,E)}catch(e){s.error({Message:v,Error:new Error(JSON.stringify(e))})}const S={repoPath:E,openREADME:u,findEnvironment:g};C===De.CanClone?(async(e,t,n,a,s,i)=>{const{errors:o}=h.GitClone,r=await e.execute("terminal:create-new");let l="";s&&(l+=`cd ${s} && `),l+=`git clone ${i} && exit\r`;try{const s=r.content;s.session.send({type:"stdin",content:[l]}),s.session.connectionStatusChanged.connect((async a=>{if("disconnected"===a.connectionStatus)try{await Ie(e,t,n)}catch(e){await(0,k.showErrorMessage)(o.failedOptions,o.failedOptionsBody,[k.Dialog.warnButton({label:"DISMISS"})])}})),await a.refresh()}catch(e){r.dispose(),await(0,k.showErrorMessage)(o.generalCloneErrorTitle,{message:o.generalCloneErrorBody+e})}})(a,n,S,r,p,l):C===De.AlreadyCloned&&Ie(a,n,S)})(t,n,d,l,p),isEnabled:()=>e.serviceManager.terminals.isAvailable()}),i.addFactory("FileBrowser","gitClone",(()=>k.ReactWidget.create(b().createElement(k.UseSignal,{signal:a.repositoryChanged,initialArgs:{name:"pathRepository",oldValue:null,newValue:a.pathRepository}},((t,n)=>b().createElement(k.ToolbarButtonComponent,{enabled:null===(null==n?void 0:n.newValue),icon:Fe.W6,onClick:()=>{e.commands.execute(Oe.TQ.gitClone)},tooltip:u.__("Git Clone")})))))),(0,Ae.ZM)(a,n,e.serviceManager.contents,e.contextMenu,u),p.info({Message:"Successfully loaded Git extension"})}},We=e=>{var t,n;const a=`${e}.AWSSageMakerUI`;return performance.mark(a),performance.measure(a,void 0,a),null!==(n=null===(t=performance.getEntriesByName(a,"measure")[0])||void 0===t?void 0:t.duration)&&void 0!==n?n:0},He={id:i,requires:[Be.ILogger],autoStart:!0,activate:(e,t)=>{((e,t)=>{const n=null===window||void 0===window?void 0:window.performance.getEntriesByType("resource");let a={};Array.isArray(n)&&n.length>0&&n.forEach((e=>{const{duration:t,requestStart:n,responseStart:s,startTime:i}=e;n&&t&&(a={...a,TimeToFirstByteMS:Math.round(s-i)})}));let s=null,i=null,o=null,r=null,l=null;const c=performance.getEntriesByType("navigation")[0];if(c)s=c.redirectCount,i=c.redirectEnd-c.redirectStart,o=Math.round(c.domContentLoadedEventEnd),r=Math.round(c.responseStart),l=Math.round(c.loadEventEnd);else{const e=performance.timing;s=performance.navigation.redirectCount,i=e.redirectEnd-e.redirectStart,o=e.domContentLoadedEventEnd-e.navigationStart,r=e.responseStart-e.navigationStart,l=e.loadEventEnd-e.navigationStart}a={...a,RedirectCount:s,RedirectTimeMS:i,TimeToDOMContentLoadedMS:o,TimeToFirstByteMS:r,TimeToOnLoadMS:l},e.info(a),t.started.then((()=>{e.info({TimeToAppStartedMS:Math.round(We("timeToAppStarted"))})})),t.restored.then((()=>{const t=(n=Math.round(We("timeToAppRestored")))>0?n:null;var n;e.info({TimeToAppRestoredMS:t||void 0})}))})(Ne(t,i,Be.logSchemas.performance),e)}};var Je=n(80087),qe=n(28201);const Ye={SpaceMenuHeader:W.css`
  margin: -6px 0;
  padding: 0 var(--jp-size-2);
  height: 10;
  border-radius: var(--jp-radius-small);
  font-size: var(--jp-size-3);
  display: flex;
  justify-content: center;
  align-items: center;

  & > p {
    display: inline-block;
    user-select: none;
    color: var(--jp-color-root-light-800);
  }

  & > svg {
    padding: 0 var(--jp-size-2);
  }
`},{unknownSpace:Qe,unknownUser:Xe}=h.Space,Ke=({spaceName:e})=>{const t=!!e,n=_("studioUserProfileName");return b().createElement("div",{className:Ye.SpaceMenuHeader,"data-testid":f},t?b().createElement(Je.Z,{fontSize:"small"}):b().createElement(qe.Z,{fontSize:"small"}),b().createElement("p",null,`${n&&n[1]||Xe} / ${t?e:Qe}`))};class et extends k.ReactWidget{constructor(){super(),this.getSpaceName=async()=>{await V("aws/sagemaker/api/context",G.GET).then((e=>{e&&e.json().then((e=>{this.spaceName=e?null==e?void 0:e.spaceName:null,this.update()}))}))},this.spaceName="",this.getSpaceName()}render(){return b().createElement(Ke,{spaceName:this.spaceName})}}const tt={id:r,requires:[Be.ILogger],autoStart:!0,activate:async(e,t)=>{const n=new et;n.id=k.DOMUtils.createDomID();const a=Ne(t,r);e.shell.add(n,"top",{rank:1e3}),window&&window.panorama&&window.panorama("trackCustomEvent",{eventType:"render",eventDetail:"Space-Plugin",eventContext:"JupyterLab",timestamp:Date.now()}),a.info({Message:"Successfully loaded Space plugin"})}};var nt=n(91973),at=n.n(nt);const st=h.ProjectsCloneRepo.errorDialog,it=[{name:"README.ipynb",factory:"Notebook"},{name:"README.md",factory:"Markdown Preview"}],ot=async(e,t,n,a)=>{let s=Z.PathExt.join(e,t);s=s.replace("$HOME","."),n.commands.execute("filebrowser:go-to-path",{path:s});const i=await a.get(s);if("directory"===i.type){const e=it.find((e=>i.content.some((t=>t.name===e.name))));e&&await n.commands.execute("docmanager:open",{path:Z.PathExt.join(s,e.name),factory:e.factory})}},rt=async e=>(0,k.showErrorMessage)(st.errorTitle,{message:e}),lt={id:o,requires:[x.IRouter,Be.ILogger,ge.IDefaultFileBrowser],autoStart:!0,activate:async(e,t,n,a)=>{const{commands:s,serviceManager:i}=e,r=i.contents,l="projects:clone-repository",c=Ne(n,o);s.addCommand(l,{execute:()=>(async(e,t,n,a,s)=>{const{search:i}=e.current;if(!i)return await rt(st.invalidRequestErrorMessage),void n.error({Error:new Error("Invalid cloning parameters: Query params must be specified")});const o=s.model,{is_efs:r,project_name:l="",repo_name:c="",clone_url:d="",code_commit:p}=Z.URLExt.queryStringToObject(i),u=await(async()=>{let e;try{e=await V("aws/sagemaker/api/projects/list-projects",G.GET)}catch(e){throw await rt(st.defaultErrorMessage),e}const t=await e.json(),{projectsList:n}=t;return n})();if(!(e=>""!==e&&/^https:\/\/[-\w.]+\.[A-Za-z]+\/[-\w@/.]+(?:\.git)?\/?(?:#.*)?$/.test(e))(d))return await rt(st.invalidCloneUrlBody),void n.error({Message:"Invalid cloning parameters: Clone URL is not valid"});if(!u.includes(l))return await rt(st.invalidProjectName),void n.error({Message:"Invalid project name: Project does not exist"});const g="$HOME",m=Z.PathExt.join(g,"user-default-efs"),h=Z.PathExt.join("true"===r?m:g,l),y=at()([h.replace("$HOME",".")]);let v=`if ! [[ -d ${y} ]]; then mkdir ${y}; fi && cd ${y} && `;p&&(v+="git config --global credential.https://git-codecommit.*.amazonaws.com.helper '!aws codecommit credential-helper $@' && git config --global credential.https://git-codecommit.*.amazonaws.com.usehttppath true &&"),v+="git config --global credential.helper 'cache --timeout=3600' && git config --global credential.usehttppath true &&";const f=at()([d]);v+=`git clone ${f} && exit\r`,t.restored.then((async()=>{try{let e=Z.PathExt.join(h,c);if(e=e.replace("$HOME","."),"directory"===(await a.get(e)).type)return ot(h,c,t,a),void await o.refresh()}catch(e){n.info({Message:"Directory does not exist, creating directory."})}const e=await t.commands.execute("terminal:create-new");try{const n=e.content;n.session.send({type:"stdin",content:[v]}),t.commands.execute("launcher:create"),n.session.connectionStatusChanged.connect((async e=>{"disconnected"===e.connectionStatus&&(ot(h,c,t,a),n.session.shutdown())})),await o.refresh()}catch(t){try{const e=Z.PathExt.join(h,c);await a.delete(e)}catch(e){n.error({Message:"Failed to cleanup partial clone"})}e.dispose();const s=t instanceof Error?t.message:String(t);await rt(s)}}))})(t,e,c,r,a)}),t.register({command:l,pattern:new RegExp("[?]command=clone-repository"),rank:10})}};var ct=n(40104),dt=n(96399);const pt={errorText:{color:"var(--jp-error-color0)"},linkColor:{color:"var(--jp-content-link-color)"},importantNote:{marginTop:"10px",fontWeight:"bold"},pluginListEntry:{paddingTop:"8px",marginTop:"10px"}},ut=({children:e})=>b().createElement("span",{style:pt.errorText,className:"jp-PluginList-entry-label-text"},e);var gt;!function(e){e.IAM="iam"}(gt||(gt={}));const mt=new dt.LabIcon({name:"libmgmt:library-management-icon",svgstr:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n    <path class="jp-icon3 jp-icon-selectable" fill="#616161" d="M4 3C3.44772 3 3 3.44772 3 4V20C3 20.5523 3.44772 21 4 21H14C14.5523 21 15 20.5523 15 20V15.2973L15.9995 19.9996C16.1143 20.5398 16.6454 20.8847 17.1856 20.7699L21.0982 19.9382C21.6384 19.8234 21.9832 19.2924 21.8684 18.7522L18.9576 5.0581C18.8428 4.51788 18.3118 4.17304 17.7716 4.28786L14.9927 4.87853C14.9328 4.38353 14.5112 4 14 4H10C10 3.44772 9.55228 3 9 3H4ZM10 6H13V14H10V6ZM10 19V16H13V19H10ZM8 5V15H5V5H8ZM8 17V19H5V17H8ZM17.3321 16.6496L19.2884 16.2338L19.7042 18.1898L17.7479 18.6057L17.3321 16.6496ZM16.9163 14.6933L15.253 6.86789L17.2092 6.45207L18.8726 14.2775L16.9163 14.6933Z"/>\n</svg>'}),ht={Python:{CondaPackages:{title:"Python - Conda Packages/Extensions",icon:new dt.LabIcon({name:"libmgmt:conda-icon",svgstr:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path class="jp-icon3 jp-icon-selectable"  d="M3.54174 11.7007C3.01586 11.6481 2.48998 11.5487 1.97579 11.4085L1.92905 11.3968L1.94073 11.3501C2.09265 10.8534 2.28548 10.3684 2.51336 9.90684L2.53673 9.8601L2.57763 9.88347C2.92237 10.0763 3.29048 10.2516 3.6586 10.4035L3.69366 10.4152L3.68781 10.4503C3.62938 10.8417 3.60017 11.2449 3.58848 11.6481V11.7007H3.54174ZM4.67529 4.62471V4.61302C4.37145 4.61886 4.06761 4.63639 3.76962 4.67145C3.80467 4.98113 3.86311 5.28497 3.92738 5.58297C4.13773 5.23239 4.38898 4.91102 4.67529 4.62471ZM3.59432 12.0571V12.0162L3.55342 12.0104C3.10935 11.9694 2.65943 11.8935 2.21536 11.7883L2.0985 11.7591L2.16277 11.8643C2.56594 12.472 3.05676 13.0095 3.62354 13.4653L3.71703 13.5412L3.6995 13.4244C3.63523 12.9569 3.60017 12.4953 3.59432 12.0571ZM5.7621 1.39349C5.2187 1.58047 4.70451 1.83172 4.23122 2.1414C4.58765 2.20567 4.94407 2.28748 5.28881 2.39265C5.42905 2.04791 5.58681 1.7207 5.7621 1.39349ZM8.02337 1.01953C7.75459 1.01953 7.49165 1.03706 7.22871 1.06628C7.59683 1.32337 7.95326 1.60384 8.28631 1.91352L8.56678 2.17062L8.29215 2.43355C8.06427 2.64975 7.84808 2.88347 7.63773 3.13472L7.62604 3.14641C7.62604 3.14641 7.58514 3.19315 7.52087 3.26911C7.68447 3.25158 7.85392 3.2399 8.02337 3.2399C10.6469 3.2399 12.7796 5.36678 12.7796 7.99616C12.7796 10.6197 10.6528 12.7524 8.02337 12.7524C7.11185 12.7524 6.25876 12.4953 5.54007 12.0513C5.18364 12.0922 4.82721 12.1097 4.46494 12.1097C4.29549 12.1097 4.13189 12.1038 3.96244 12.098C3.97412 12.6414 4.02671 13.1965 4.11436 13.7808C5.23038 14.5346 6.57429 14.9786 8.02337 14.9786C11.8798 14.9786 15 11.8526 15 8.002C15 4.14558 11.8798 1.01953 8.02337 1.01953ZM7.10017 2.66728C7.2404 2.50367 7.38063 2.34591 7.52671 2.18815C7.1995 1.90768 6.85476 1.65643 6.49249 1.42855C6.27045 1.8025 6.07763 2.19399 5.91402 2.59132C6.22955 2.70818 6.53339 2.84257 6.83723 2.98865C6.97162 2.80751 7.07095 2.70234 7.10017 2.66728ZM2.36144 6.65225L2.39065 6.69315L2.43155 6.66394C2.75292 6.43022 3.09182 6.21402 3.4424 6.0212L3.47746 6.00952L3.46578 5.96861C3.3606 5.57713 3.2788 5.16811 3.22621 4.75325L3.22037 4.70651L3.17362 4.7182C2.65943 4.81169 2.14524 4.95192 1.65442 5.12721L1.60768 5.14474L1.62521 5.19148C1.82972 5.69399 2.07513 6.18481 2.36144 6.65225ZM2.27963 7.32421L2.23873 7.35342C1.86477 7.65726 1.50835 7.99616 1.18114 8.35843L1.14608 8.39349L1.18114 8.4227C1.54341 8.73823 1.93489 9.03038 2.34391 9.28748L2.38481 9.31669L2.40818 9.27579C2.58932 8.94858 2.79967 8.62721 3.0217 8.31753L3.04508 8.28831L3.0217 8.2591C2.76461 7.97279 2.52504 7.67479 2.30301 7.35926L2.27963 7.32421ZM5.02003 11.724L5.14274 11.7182L5.04925 11.6422C4.67529 11.3384 4.35392 10.982 4.09099 10.573V10.5613L4.01502 10.5262L4.00334 10.5905C3.95659 10.9411 3.92738 11.3033 3.92154 11.6773V11.724H3.96828C4.13189 11.7357 4.30134 11.7357 4.46494 11.7357C4.64608 11.7416 4.83306 11.7357 5.02003 11.724ZM4.78631 4.01703C4.86227 3.67229 4.95576 3.33339 5.06678 3.00033C4.62855 2.87763 4.17863 2.78414 3.72871 2.71987C3.68781 3.17562 3.68197 3.63138 3.71119 4.0813C4.06761 4.0404 4.42988 4.02287 4.78631 4.01703ZM5.45826 3.99366C5.7621 3.80083 6.08932 3.63723 6.43406 3.51452C6.18865 3.4035 5.94324 3.29833 5.68614 3.20484C5.5985 3.46194 5.52254 3.73072 5.45826 3.99366ZM2.21536 9.66144L2.1803 9.63806C1.81803 9.41018 1.47329 9.15893 1.14608 8.89015L1.05259 8.81419L1.07012 8.93689C1.15776 9.60885 1.34474 10.2574 1.61937 10.8768L1.66611 10.9878L1.70701 10.8768C1.8414 10.4795 2.01085 10.088 2.19783 9.71402L2.21536 9.66144ZM3.10935 3.04123C2.69449 3.45609 2.32638 3.9177 2.02838 4.42604C2.39065 4.32087 2.75292 4.23322 3.12104 4.16895C3.09766 3.79499 3.09182 3.42103 3.10935 3.04123ZM3.3197 7.93773L3.32554 7.81502C3.34307 7.38848 3.41319 6.97362 3.54174 6.57045L3.57679 6.45359L3.47162 6.51202C3.197 6.66978 2.92821 6.84507 2.67112 7.03205L2.63022 7.06127L2.65943 7.10217C2.84057 7.35926 3.03339 7.61052 3.2379 7.85008L3.3197 7.93773ZM3.36644 8.65058L3.34891 8.53372L3.2788 8.6389C3.08598 8.91352 2.90484 9.19399 2.74124 9.48614L2.71786 9.52704L2.75876 9.55042C3.05092 9.71402 3.3606 9.86594 3.67028 10.0003L3.7813 10.0471L3.72871 9.93606C3.54758 9.52704 3.42488 9.09466 3.36644 8.65058ZM2.00501 6.98531L2.04007 6.95609L2.01669 6.92103C1.8005 6.57045 1.60184 6.20234 1.42654 5.82838L1.37396 5.7232L1.3389 5.84007C1.13439 6.47112 1.02337 7.13138 1.00584 7.7975L1 7.9202L1.08765 7.83255C1.37396 7.52871 1.68364 7.23656 2.00501 6.98531Z" fill="white"/>\n</svg>\n'}),supportedConnectionType:[gt.IAM],additionalDescription:[b().createElement("div",{key:"conda-desc-1"},"Use this interface to manage automatic Conda package installations for your environment. Packages specified here will be installed each time your space runs."),b().createElement("div",{key:"conda-desc-2"},"Enter package names and optional version constraints (e.g., pandas or pandas",">","=1.0.0)"),b().createElement("div",{key:"conda-desc-3"},"For more information on package specification, see ",("Conda package specification","https://docs.conda.io/projects/conda-build/en/latest/resources/package-spec.html",b().createElement((({href:e,children:t})=>b().createElement("a",{target:"_blank",style:pt.linkColor,rel:"noopener noreferrer",href:e},t)),{href:"https://docs.conda.io/projects/conda-build/en/latest/resources/package-spec.html"},"Conda package specification"))),b().createElement((({children:e})=>b().createElement("div",{style:pt.importantNote},e)),{key:"conda-desc-4"},"Important Notes:"),b().createElement("div",{key:"conda-desc-5"},"• Closing the background terminal cancels ongoing installations"),b().createElement("div",{key:"conda-desc-6"},"• After package installation, Jupyter server automatically restarts. This restart clears all in-memory variables and active sessions"),b().createElement("div",{key:"conda-desc-7"},"• Removing packages from this interface only prevents future installations. Package uninstallation must be done separately"),b().createElement("div",{key:"conda-desc-8"},"• Channel priorities set here apply only to this interface. Packages installed via notebook or terminal are not tracked here"),b().createElement("div",{key:"conda-desc-9"},"• Installation requires internet access (except for custom channels)")]}}};const yt={ApplyChangeToSpace:!1,Python:{CondaPackages:{Channels:[],PackageSpecs:[]}}};class vt extends B.DocumentManager{constructor(e){super(e),this.autosave=!1}async exist(e){try{return await this.services.contents.get(e),!0}catch(e){if(e&&"object"==typeof e&&"response"in e&&e.response&&"object"==typeof e.response&&"status"in e.response&&404===e.response.status)return!1;throw e}}async _openOrReveal(e,t){return super.openOrReveal(e,t)}async openOrCreate(e,t="default"){try{await this.services.contents.get(e)}catch(t){if(!(t&&"object"==typeof t&&"response"in t&&t.response&&"object"==typeof t.response&&"status"in t.response&&404===t.response.status))throw t;{const t=(new Date).toISOString(),n={created:t,last_modified:t,mimetype:"application/json",writable:!0,type:"file",format:"text",name:e,path:e,content:JSON.stringify(yt)};await this.services.contents.save(e,n)}}return this._openOrReveal(e,t)}}var ft=n(34882),wt=n(74901);class Et extends dt.ReactWidget{constructor(e){super(),this._selectedType="Python",this._selectedSource="CondaPackages",this._handleSelectTypeSignal=new wt.Signal(this),this._handleSelectSourceSignal=new wt.Signal(this),this._isSaving=!1,this.addClass("jp-PluginList"),this._updateSpace=e.updateSpace,this._onCheckUpdateSpace=t=>{this._updateSpace=t,e.onCheckUpdateSpace(t),this.update()},this._onSave=e.onSave,this._schema=e.schema,this._evtMousedown=this._evtMousedown.bind(this),this._onSave=this._onSave.bind(this),this.setError=this.setError.bind(this),this._errors={}}get handleSelectTypeSignal(){return this._handleSelectTypeSignal}get handleSelectSourceSignal(){return this._handleSelectSourceSignal}mapConfig(e,t,n){const a=n.title,s=ht[e][t];return b().createElement("div",{onClick:this._evtMousedown,className:`${e===this._selectedType&&t===this._selectedSource?"jp-mod-selected jp-PluginList-entry":"jp-PluginList-entry"} ${this.hasError(e,t)?"jp-ErrorPlugin":""}`,"data-selected-type":e,"data-selected-source":t},b().createElement("div",{className:"jp-PluginList-entry-label",role:"tab"},b().createElement("div",{className:"jp-SelectedIndicator"}),b().createElement(dt.LabIcon.resolveReact,{icon:s.icon,iconClass:"jp-Icon",tag:"span",stylesheet:"settingsEditor"}),b().createElement("span",{className:"jp-PluginList-entry-label-text"},a)))}render(){let e=[];if(this._schema.properties){const t=this._schema.properties;e=Object.keys(t).map((e=>{const n=t[e].properties,a=n?Object.keys(n).map((t=>this.mapConfig(e,t,n[t]))):[];return b().createElement("div",{key:e},b().createElement("h1",{className:"jp-PluginList-header"},e),b().createElement("ul",null,a))}))}return b().createElement("div",{className:"jp-PluginList-wrapper"},b().createElement("div",{className:"jp-SettingsHeader"},b().createElement("h3",null,"Environment Management")),e,b().createElement("div",{className:"jp-PluginList-entry",style:pt.pluginListEntry},b().createElement("div",{className:"jp-PluginList-entry"},b().createElement("div",{className:"jp-PluginList-entry-label"},b().createElement("input",{type:"checkbox",className:"jp-mod-styled jp-pluginmanager-Disclaimer-checkbox",checked:this._updateSpace,onChange:e=>this._onCheckUpdateSpace(e.target.checked)}),b().createElement("span",null,"Install in current session"))),b().createElement("div",{className:"jp-PluginList-entry"},b().createElement(dt.Button,{className:"jp-mod-styled jp-mod-reject jp-ArrayOperationsButton",disabled:this._isSaving||this.hasErrors,onClick:()=>this.onSave()},this._isSaving?"Saving...":"Save all changes")),this.hasErrors&&b().createElement("div",{className:"jp-PluginList-entry"},b().createElement("div",{className:"jp-PluginList-entry-label"},b().createElement(dt.LabIcon.resolveReact,{icon:dt.errorIcon,iconClass:"jp-Icon",tag:"span",stylesheet:"settingsEditor"}),b().createElement(ut,null,"You must resolve all errors to save")))))}_evtMousedown(e){const t=e.currentTarget,n=t.getAttribute("data-selected-type"),a=t.getAttribute("data-selected-source");n&&a&&(this._selectedType=n,this._handleSelectTypeSignal.emit(n),this._selectedSource=a,this._handleSelectSourceSignal.emit(a),this.update())}async onSave(){if(this.hasErrors||this._isSaving)this.update();else{this._isSaving=!0,this.update();try{await this._onSave()}finally{this._isSaving=!1,this.update()}}}hasError(e,t){return!!this._errors[e]&&this._errors[e][t]}get hasErrors(){for(const e in this._errors)for(const t in this._errors[e])if(this._errors[e][t])return!0;return!1}setError(e,t,n){this._errors[e]||(this._errors[e]={}),this._errors[e][t]!==n?(this._errors[e][t]=n,this.update()):this._errors[e][t]=n}}var Ct=n(21761),St=n.n(Ct);const bt=e=>e.map((e=>"pattern"===e.name?{...e,message:"Invalid input"}:e)),xt=({schema:e,config:t,onChange:n,hasError:a,selectedType:s,selectedSource:i})=>b().createElement(b().Fragment,null,b().createElement("div",{className:"jp-SettingsHeader"},b().createElement("h2",{className:"jp-SettingsHeader-title"},ht[s][i].title),(()=>{const e=ht[s][i];return b().createElement("div",{className:"jp-SettingsHeader-description"},e.additionalDescription&&e.additionalDescription.length>0&&b().createElement("div",null,e.additionalDescription))})()),Array.isArray(e.type)&&e.type.includes("object")&&e.properties?b().createElement(kt,{properties:e.properties,config:t,onChange:n,hasError:a}):b().createElement(dt.FormComponent,{schema:e,validator:St(),formData:t,onChange:e=>{a(0!==e.errors.length),n(e.formData)},liveValidate:!0,tagName:"div",translator:_e.nullTranslator,showErrorList:!1,transformErrors:bt})),kt=({properties:e,config:t,onChange:n,hasError:a})=>{const[s,i]=(0,S.useState)(null!=t?t:{}),[o,r]=(0,S.useState)({}),l=(0,S.useRef)(!1);(0,S.useEffect)((()=>{l.current=!0}),[]),(0,S.useEffect)((()=>{l.current?l.current=!1:n(s)}),[s]),(0,S.useEffect)((()=>{let e=!1;Object.keys(o).forEach((t=>e=e||o[t])),a(e)}),[o]);const c=(0,S.useMemo)((()=>{const n=[];return Object.keys(e).map((a=>{n.push(b().createElement(dt.FormComponent,{schema:e[a],validator:St(),formData:t?t[a]:{},onChange:e=>{r((t=>({...t,[a]:0!==e.errors.length}))),i((t=>{const n=JSON.parse(JSON.stringify(t));return n[a]=e.formData,n}))},liveValidate:!0,tagName:"div",translator:_e.nullTranslator,showErrorList:!1,transformErrors:bt}))})),n}),[]);return b().createElement(b().Fragment,null,c)},Mt=({schema:e,configs:t,handleSelectTypeSignal:n,handleSelectSourceSignal:a,onConfigsChange:s,setError:i})=>{const[o,r]=(0,S.useState)("Python"),[l,c]=(0,S.useState)("CondaPackages");(0,S.useEffect)((()=>{var e,t;const s=(e,t)=>{r(t)};null===(e=null==n?void 0:n.connect)||void 0===e||e.call(n,s);const i=(e,t)=>{c(t)};return null===(t=null==a?void 0:a.connect)||void 0===t||t.call(a,i),()=>{var e,t;null===(e=null==n?void 0:n.disconnect)||void 0===e||e.call(n,s),null===(t=null==a?void 0:a.disconnect)||void 0===t||t.call(a,i)}}),[]);const d=(0,S.useMemo)((()=>o&&l?e.properties[o].properties[l]:{}),[o,l,e]),p=(0,S.useMemo)((()=>o&&l?t[o][l]:{}),[o,l,t]),u=(0,S.useCallback)((e=>{i(o,l,e)}),[i,o,l]);return b().createElement("div",{className:"jp-SettingsPanel"},b().createElement("div",{className:"jp-SettingsForm"},b().createElement(xt,{schema:d,config:p,onChange:e=>{const n=JSON.parse(JSON.stringify(t));n[o][l]=e,s(n)},hasError:u,selectedType:o,selectedSource:l})))},jt="^[a-zA-Z0-9._:/=<>!~^*,|-]+$",_t={title:"Library management configuration",description:"Library management configuration",type:["object","null"],properties:{Python:{type:"object",title:"Python",properties:{CondaPackages:{title:"Conda Packages/Extensions",type:["object","null"],properties:{Channels:{title:"Package Channels",type:["array","null"],items:{type:"string",pattern:jt}},PackageSpecs:{title:"Package Specifications",type:["array","null"],items:{type:"string",pattern:jt}}}}}}}};class Lt extends ft.SplitPanel{constructor(e,t,n,a){super({orientation:"horizontal",renderer:ft.SplitPanel.defaultRenderer,spacing:1}),this._config={},this._updateSpace=!1,this._context=e,this._createTerminal=t,this._openTerminal=n,this._logger=a,this.onCheckUpdateSpace=this.onCheckUpdateSpace.bind(this),this.onChange=this.onChange.bind(this),this.onSave=this.onSave.bind(this),this._initialize().then((()=>{this.addClass("jp-SettingsPanel");const e=new Et({schema:_t,updateSpace:this._updateSpace,onCheckUpdateSpace:this.onCheckUpdateSpace,onSave:this.onSave});e.handleSelectSourceSignal.connect((()=>{this.update()})),this.addWidget(e);const t=k.ReactWidget.create(b().createElement(dt.UseSignal,{signal:e.handleSelectSourceSignal},(()=>b().createElement(Mt,{schema:_t,configs:this._config,handleSelectTypeSignal:e.handleSelectTypeSignal,handleSelectSourceSignal:e.handleSelectSourceSignal,onConfigsChange:this.onChange,setError:e.setError}))));this.addWidget(t)})).catch((e=>{var t,n;null===(t=this._logger)||void 0===t||t.error({Message:"Error loading widget due to corrupt configuration file",Error:e}),this.addWidget(k.ReactWidget.create(b().createElement("div",{className:"jp-PluginList-entry-label"},b().createElement(dt.LabIcon.resolveReact,{icon:dt.errorIcon,iconClass:"jp-Icon",tag:"span",stylesheet:"settingsEditor"}),(n=this._context.path,b().createElement(b().Fragment,null,b().createElement(ut,null,"The configuration file ",n," is corrupted or invalid.",b().createElement("br",null),b().createElement("br",null),"To resolve this issue:",b().createElement("br",null),"• Remove the corrupted file and restart the UI (you will need to reconfigure preferences), OR",b().createElement("br",null),"• Fix the file format back to how it was originally",b().createElement("br",null),b().createElement("br",null),"Note: Removing the file will reset all saved extension and package configurations.",b().createElement("br",null),"Please exit and reopen this widget after making changes."))))))}))}onCheckUpdateSpace(e){this._updateSpace=e;const t=JSON.parse(JSON.stringify(this._config));t.ApplyChangeToSpace=e,this._context.model.fromJSON(t)}onChange(e){this._context.model.fromJSON(e),this._config=e,this.update()}async onSave(){var e,t;try{if(await this._context.save(),null===(e=this._logger)||void 0===e||e.info({Message:"Saved package configurations"}),this._updateSpace&&this._config.Python){const{installPackagesFromConfig:e}=await Promise.resolve().then(n.bind(n,81687));await e(this._config,this._createTerminal,this._openTerminal,this._logger)}}catch(e){null===(t=this._logger)||void 0===t||t.error({Message:"Error saving packing configurations",Error:e})}}async _initialize(){var e;await this._context.ready,this._context.model.contentChanged.connect(this.onContentChange,this),this._config=this._context.model.toJSON(),this._updateSpace=null!==(e=this._config.ApplyChangeToSpace)&&void 0!==e&&e}onContentChange(){this._config=this._context.model.toJSON()}}class Tt extends U.DocumentWidget{constructor(e,t,n,a){super({content:new Lt(e,t,n,a),context:e}),this.title.icon=mt}}class Rt extends U.ABCWidgetFactory{constructor(e,t,n,a){super(e),this._createTerminal=t,this._openTerminal=n,this._logger=a}createNewWidget(e){return new Tt(e,this._createTerminal,this._openTerminal,this._logger)}}var Nt=n(81687);const Dt=new class{constructor(){this.baseUrl=Z.PageConfig.getBaseUrl(),this.settings=A.ServerConnection.makeSettings({baseUrl:this.baseUrl})}async checkMarkerFile(){const e=`${this.baseUrl}aws/sagemaker/api/create-marker-file`,t=await A.ServerConnection.makeRequest(e,{method:"GET",headers:{"Content-Type":"application/json"}},this.settings);if(!t.ok)throw new Error(`Failed to check marker file: ${t.statusText}`);return(await t.json()).exists}async createMarkerFile(){const e=`${this.baseUrl}aws/sagemaker/api/create-marker-file`,t=await A.ServerConnection.makeRequest(e,{method:"POST",headers:{"Content-Type":"application/json"}},this.settings);if(!t.ok)throw new Error(`Failed to create marker file: ${t.statusText}`);return(await t.json()).created}};async function Pt(){return await Dt.createMarkerFile()}var It;!function(e){e.EDIT_LIBRARY_CONFIG="edit-library-config"}(It||(It={}));const Ut=[w,F,ue,Ve,He,tt,lt,{id:l,autoStart:!0,requires:[Be.ILogger],optional:[ct.ILauncher,B.IDocumentWidgetOpener],activate:async(e,t,n,a)=>{const s=Ne(t,l);try{const e=await V("aws/sagemaker/api/is-md-environment",G.GET);if((await e.json()).isMaxDomeEnvironment)return}catch(e){return void s.error({Message:"Unable to fetch environment"})}const{commands:i,docRegistry:o}=e,r=async()=>await e.serviceManager.terminals.startNew(),c=t=>{e.shell.add(t,"main",{activate:!0})},d=new Rt({name:"library-config-editor",fileTypes:["file"],defaultFor:[]},r,c,s);o.addWidgetFactory(d);const p=new vt({registry:o,manager:e.serviceManager,opener:a});e.restored.then((async()=>{try{if(!await async function(){return await Dt.checkMarkerFile()}())try{const t=await e.serviceManager.contents.get(".libs.json",{content:!0});if(t.content){const e=JSON.parse(t.content);try{await(0,Nt.installPackagesFromConfig)(e,r,c,s)}catch(e){}await Pt()}}catch(e){await Pt()}}catch(e){}}));const u=It.EDIT_LIBRARY_CONFIG;i.addCommand(u,{label:"Environment management",icon:e=>e.isPalette?void 0:mt,execute:async()=>{try{await p.openOrCreate(".libs.json","library-config-editor")}catch(e){(0,k.showErrorMessage)("Failed to open Environment Management config",e.message)}}}),n&&(n.add({command:u,category:"Other",rank:1}),s.info({Message:"Successfully loaded Extension Management plugin"}))}}]},81687:(e,t,n)=>{n.d(t,{installPackagesFromConfig:()=>m});var a=n(35238),s=n(95366),i=n(23776),o=n(40082);const r=new class{constructor(){this.baseUrl=o.PageConfig.getBaseUrl(),this.settings=i.ServerConnection.makeSettings({baseUrl:this.baseUrl})}async sendMetric(e,t){const n=`${this.baseUrl}aws/sagemaker/api/add-metrics`,a={metric:e,...t&&{output:t}},s={method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}},o=await i.ServerConnection.makeRequest(n,s,this.settings);if(!o.ok)throw new Error(`Failed to send metric: ${o.statusText}`)}};function l(e,t,n="Extension Management"){const a={_aws:{Timestamp:Date.now(),CloudWatchMetrics:[{Namespace:n,Dimensions:[["Operation"]],Metrics:[]}]},Operation:e};void 0!==t.latency&&(a._aws.CloudWatchMetrics[0].Metrics.push({Name:"Latency",Unit:"Milliseconds"}),a.Latency=t.latency),void 0!==t.success&&(a._aws.CloudWatchMetrics[0].Metrics.push({Name:"Success",Unit:"Count"}),a.Success=t.success),void 0!==t.error&&(a._aws.CloudWatchMetrics[0].Metrics.push({Name:"Error",Unit:"Count"}),a.Error=t.error),Object.keys(t).forEach((e=>{["latency","success","error","output"].includes(e.toLowerCase())||(a._aws.CloudWatchMetrics[0].Metrics.push({Name:e,Unit:"None"}),a[e]=t[e])})),async function(e,t){const n=JSON.parse(e);await r.sendMetric(n,t)}(JSON.stringify(a),t.output)}var c;!function(e){e[e.RUNNING=0]="RUNNING",e[e.SUCCESS=1]="SUCCESS",e[e.FAILURE=2]="FAILURE"}(c||(c={}));const d='echo "EXIT_CODE: $?"',p="EXIT_CODE:",u="EXIT_CODE: 0",g="All requested packages already installed";async function m(e,t,n,i){const o=Date.now();if(!e.Python)return;const r=e.Python;if(!r.CondaPackages)return;const m=r.CondaPackages,h=m.PackageSpecs,y=m.Channels;if(h.length>0){null==i||i.info({Message:"Installing packages and extensions from config"});const e=await t(),r=new s.Terminal(e);r.id="installLab"+(new Date).getMilliseconds(),r.title.closable=!0;const m=`micromamba install --freeze-installed -y ${y.map((e=>`-c "${e}"`)).join(" ")} ${h.map((e=>`"${e}"`)).join(" ")}`;let v,f=!1;const w=function(e,t,n){let a,s=c.RUNNING,i=t.length,o=!1,r="";function l(e,t){"stdout"===t.type&&t.content&&t.content.forEach((t=>{if(s===c.RUNNING&&"string"==typeof t){const a=t.replace(/\x1B\[[?0-9;]*[a-zA-Z]/g,"").replace(/\r/g,"").trim();a&&(r+=a+"\n"),t.includes(g)&&(o=!0),!t.includes(d)&&t.includes(p)&&(t.includes(u)?(i--,i||(s=c.SUCCESS,null==n||n.info({Message:"Successfully installed packages and extensions"}))):(s=c.FAILURE,e.messageReceived.disconnect(l),null==n||n.error({Message:"Failed to install packages and extensions"})))}else s=c.FAILURE,e.messageReceived.disconnect(l)}))}e.messageReceived.connect(l);let m=t.join(`;${d};`);return m+=`;${d}\n;`,e.send({type:"stdin",content:[m]}),new Promise(((t,n)=>{a=window.setInterval((()=>{if(s===c.SUCCESS){clearInterval(a),e.messageReceived.disconnect(l);try{e.shutdown().catch((()=>{}))}catch{}t({alreadyInstalled:o,output:r})}else if(s===c.FAILURE){clearInterval(a),e.messageReceived.disconnect(l);try{e.shutdown().catch((()=>{}))}catch{}n(new Error(r))}}),1e3)}))}(e,[m],i);return a.Notification.promise(w,{pending:{message:"Installing packages and extensions from saved configuration...",options:{actions:[{label:"View in terminal",callback:()=>{e.isDisposed?a.Notification.error("Terminal is disposed"):(f=!0,n(r),v=a.Notification.warning("Closing the terminal will terminate the installation process. This terminal will automatically close once installation complete.",{autoClose:!1,actions:[]}))}}],autoClose:!1}},success:{message:e=>{const{alreadyInstalled:t,output:n}=e;return l("Package Installation",{latency:Date.now()-o,success:1,error:0,output:n}),t?"All packages and extensions already installed":"Installation completed. Restart the kernel for updated libraries. Restart the server for updated extensions."},options:{actions:[{label:"Restart Server",callback:()=>{t().then((e=>{const t=new s.Terminal(e);t.id="restartServer"+(new Date).getMilliseconds(),t.title.closable=!0,n(t),e.send({type:"stdin",content:["restart-jupyter-server\n"]})}))}}],autoClose:!1}},error:{message:e=>(l("Package Installation",{latency:Date.now()-o,success:0,error:1,output:e.message}),"Failed to install packages/extensions. Check error logs in terminal."),options:{actions:[{label:"View in terminal",callback:()=>{e.isDisposed?a.Notification.error("Terminal is disposed"):n(r)}}],autoClose:!1}}}),w.then((e=>{if(f){const{alreadyInstalled:i}=e,o=i?"All packages and extensions already installed":"Installation completed. Restart the kernel for updated libraries. Restart the server for updated extensions.";a.Notification.success(o,{actions:i?[]:[{label:"Restart Server",callback:()=>{t().then((e=>{const t=new s.Terminal(e);t.id="restartServer"+(new Date).getMilliseconds(),t.title.closable=!0,n(t),e.send({type:"stdin",content:["restart-jupyter-server\n"]})}))}}],autoClose:!1})}})).catch((e=>{f&&a.Notification.error("Failed to install packages/extensions. Check error logs in terminal.",{autoClose:!1,actions:[]})})).finally((()=>{v&&a.Notification.dismiss(v)})),w}}},4147:e=>{e.exports=JSON.parse('{"name":"@amzn/sagemaker-jupyterlab-extensions","description":"SageMaker JupyterLab workspace primary extension module","version":"0.5.0","author":"Amazon","homepage":"https://aws.amazon.com/sagemaker/","license":"Amazon Software License","licenses":[{"type":"Amazon Software License","url":"http://aws.amazon.com/asl"}],"directories":{"test":"__tests__"},"files":["lib/**/*.{d.ts,eot,gif,html,jpg,js,js.map,json,png,svg,woff2,ttf}","style/**/*.{css,js,eot,gif,html,jpg,json,png,svg,woff2,ttf}","schema/*.json"],"scripts":{"copy-assets":"mkdir -p lib/plugins/LibManagementPlugin/icons && cp -r src/plugins/LibManagementPlugin/icons/* lib/plugins/LibManagementPlugin/icons/","build":"tsc && npm run copy-assets","build:labextension":"tsc && jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True --source-map True .","lint:check":"eslint . --ext .js,.ts,.tsx","lint:fix":"eslint --fix . --ext .js,.ts,.tsx","release":"run-s build","install:extension":"jlpm run build","watch:src":"tsc -w","watch:labextension":"jupyter labextension watch .","watch":"run-p watch:src watch:labextension","dev:setup":"run-s -n dev:docker:build dev:docker:reset dev:docker:create","dev:docker:build":"(cd devSetup ; sh pull-jupyterlab-base-image.sh && docker build . --tag jupyterlab_ext_dev_image --build-arg CONTAINER_USER_ID=$(id -u) --build-arg CONTAINER_GROUP_ID=$(id -g))","dev:docker:reset":"docker stop jupyterlab_ext_dev_container || true && docker rm jupyterlab_ext_dev_container || true","dev:docker:create":"docker create --name jupyterlab_ext_dev_container --publish 8888:8888 --volume $(pwd):/sagemaker-studio-extension jupyterlab_ext_dev_image","dev:start":"docker start jupyterlab_ext_dev_container --attach","test":"jest","test:watch":"jest --watch"},"main":"lib/index.js","dependencies":{"@amzn/sagemaker-jupyterlab-extension-common":"^0.2.0","@emotion/css":"^11.1.3","@emotion/styled":"^11.11.0","@jupyterlab/application":"^4.0.5","@jupyterlab/apputils":"^4.0.5","@jupyterlab/coreutils":"^6.0.5","@jupyterlab/docmanager":"^4.0.5","@jupyterlab/docregistry":"^4.0.5","@jupyterlab/filebrowser":"^4.0.5","@jupyterlab/git":"^0.51.1","@jupyterlab/launcher":"^4.0.5","@jupyterlab/mainmenu":"^4.0.5","@jupyterlab/services":"^7.0.0","@jupyterlab/statusbar":"^4.0.5","@jupyterlab/terminal":"^4.0.5","@jupyterlab/translation":"^4.0.5","@jupyterlab/ui-components":"^4.0.5","@lumino/algorithm":"^2.0.0","@lumino/commands":"^2.0.0","@lumino/coreutils":"^2.2.0","@lumino/polling":"^2.1.2","@lumino/signaling":"^2.1.2","@lumino/widgets":"^2.0.0","@mui/icons-material":"5.14","@mui/material":"^5.14.4","@rjsf/core":"^5.24.10","@rjsf/utils":"^5.24.10","@rjsf/validator-ajv8":"^5.24.10","cookie":"0.6.0","isomorphic-fetch":"^3.0.0","json-schema":"^0.4.0","moment":"^2.29.4","p-retry":"^5.1.2","react":"^18.2.0","react-dom":"^18.2.0","shell-escape":"^0.2.0"},"jupyterlab":{"extension":true,"outputDir":"sagemaker_jupyterlab_extension/labextension","disabledExtensions":["@jupyterlab/git:clone"],"sharedPackages":{"@amzn/sagemaker-jupyterlab-extension-common":{"bundled":false,"singleton":true,"strictVersion":false}}},"style":"src/style/index.css","devDependencies":{"@babel/preset-env":"^7.22.7","@babel/preset-react":"^7.22.5","@jupyterlab/builder":"^4.0.5","@types/jest":"^27.5.2","@types/lodash":"^4.14.172","@types/react":"^18.2.21","@types/react-dom":"^18.2.7","@types/shell-escape":"^0.2.3","@typescript-eslint/eslint-plugin":"^5.61.0","eslint-config-prettier":"^8.8.0","eslint-plugin-import":"^2.27.5","eslint-plugin-json":"^3.1.0","eslint-plugin-prettier":"^4.2.1","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","jest":"^27.2.4","npm-run-all":"^4.1.5","prettier":"^2.4.1","ts-jest":"^27.0.5","typescript":"^4.3.5","@testing-library/jest-dom":"^6.6.3","@testing-library/react":"^13.0.0"}}')}}]);